<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>初识布隆过滤器</title>
      <link href="/2021/11/14/chu-shi-bu-long-guo-lu-qi/"/>
      <url>/2021/11/14/chu-shi-bu-long-guo-lu-qi/</url>
      
        <content type="html"><![CDATA[<h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>最近在看《Hbase原理与实战》这本书，在Hbase底层通过使用Bloom Filter这样的结构来减少对不必要的的行列的检索，所以觉得有必要记录一下。</p><h2 id="问题引出"><a href="#问题引出" class="headerlink" title="问题引出"></a>问题引出</h2><p>如何高效的判断一个元素是否存在于一个集合当中？</p><p>对于这个问题，可以把集合中的元素一个个放入哈希表，然后在哈希表中查找一下即可。</p><p>这种做法在小数据量场景下确实容易实现，但是当集合中的元素数量非常巨大时，甚至远远超过机器内存空间，该如何解决？</p><h2 id="什么是布隆过滤器"><a href="#什么是布隆过滤器" class="headerlink" title="什么是布隆过滤器"></a>什么是布隆过滤器</h2><p>​    布隆过滤器（Bloom Filter），是1970年，由一个叫布隆的人提出的，距今已经五十年了。它其实是一个很长的二进制向量和一系列随机映射函数，由一个长度为N的01数组组成。主要用于判断一个元素是否在一个集合中，0表明不存在某个数据，1表明存在某个数据。</p><h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><ul><li><p>数据库场景</p><p>BigTable、Hbase使用布隆过滤器减少对不存在的行、列查找。</p></li><li><p>缓存类场景</p><p>Redis使用布隆过滤器防止缓存穿透。</p></li><li><p>去重场景</p><ul><li>Medium使用布隆过滤器避免推荐给用户已经读过的文章。</li><li>在爬虫时，对爬虫网址进行过滤，已经存在布隆过滤器中的网址，不再爬取。</li></ul></li><li><p>安全场景</p><ul><li>垃圾邮件过滤，对每个发送邮件的地址进行判断是否在布隆过滤器的黑名单中，若是在就判断为垃圾邮件。</li><li>Chrome使用布隆过滤器识别恶意URL数据结构。</li></ul></li></ul><h2 id="原理实现"><a href="#原理实现" class="headerlink" title="原理实现"></a>原理实现</h2><h3 id="插入过程"><a href="#插入过程" class="headerlink" title="插入过程"></a>插入过程</h3><img src="http://tva1.sinaimg.cn/large/006SFsamly1gwo8ghbwtlj30wz0dqwga.jpg" alt="插入元素" style="zoom:67%;"><ol><li><p>经过K个哈希函数计算该数据，返回K个计算出的hash值</p></li><li><p>这些K个hash值映射到对应的K个二进制的数组下标</p></li><li><p>将K个下标对应的二进制数据改为1。</p><p><strong>例如，第一个哈希函数返回x，第二个第三个哈希函数返回y与z，那么：X、Y、Z对应的二进制改为1。</strong></p></li></ol><h3 id="查找过程"><a href="#查找过程" class="headerlink" title="查找过程"></a>查找过程</h3><img src="http://tva1.sinaimg.cn/large/006SFsamly1gwo8hqwyttj30wa0cytat.jpg" alt="查找元素" style="zoom:67%;"><ol><li><p>经过K个哈希函数计算该数据，对应计算出的K个hash值</p></li><li><p>经过hash值找到对应的二进制的数组下标</p><p><strong>判断：若是存在一处位置的二进制数据是0，那么该数据不存在。若是都是1，该数据存在集合中。（这里有缺点，下面会讲）</strong></p></li></ol><h3 id="误判情形"><a href="#误判情形" class="headerlink" title="误判情形"></a>误判情形</h3><img src="http://tva1.sinaimg.cn/large/006SFsamly1gwo8jrdxddj311c08jwiz.jpg" alt="误判情形" style="zoom:50%;"><p>“你好”与“Hello”经过哈希函数映射在同一个位置，会产生以下情况：</p><p>若只有一个元素存在时，对另外一个元素哈希后也可判断存在（事实上根本不存在）。</p><h2 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h2><h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><ul><li>因为存储的是二进制数据，因此占用的空间很小。</li><li>它的插入和查询速度是很是快的，时间复杂度是O(K)，能够联想一下HashMap的过程。</li><li>保密性很好，由于自己不存储任何原始数据，只有二进制数据。</li></ul><h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><ul><li>不同数据Hash到同一个位置，无法判断是否存在，因而会导致误判，比如正常邮件被当作垃圾邮件拦截。</li><li>删除困难，删除时可能导致其他元素也被删除置为0。</li></ul><h2 id="参数说明"><a href="#参数说明" class="headerlink" title="参数说明"></a>参数说明</h2><h3 id="关键参数"><a href="#关键参数" class="headerlink" title="关键参数"></a>关键参数</h3><ul><li>位数组（Bit Array）长度：m</li><li>哈希函数（Hash Function）个数：K</li><li>已添加元素数量（Items in the Filter）：n</li><li>误判率（False positive probability）：FPP(P)</li></ul><h3 id="计算公式"><a href="#计算公式" class="headerlink" title="计算公式"></a>计算公式</h3><p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gwo9f8xy51j30hz06275b.jpg" alt="各参数关系式"></p><h3 id="误判率推导"><a href="#误判率推导" class="headerlink" title="误判率推导"></a>误判率推导</h3><ol><li><p>假设 Hash 函数以等概率条件选择并设置 Bit Array 中的某一位，m 是该位数组的大小，k 是 Hash 函数的个数，位数组中某一特定的位在进行元素插入时的 Hash 操作中没有被置位的概率是：</p><p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gwo9isvpi3j308303jdfm.jpg"></p></li><li><p>在所有 k 次 Hash 操作后该位都没有被置 “1” 的概率是：</p><p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gwo9j6uydlj305y03kjr8.jpg"></p></li><li><p>插入了 n 个元素，那么某一位仍然为 “0” 的概率是：</p><p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gwo9loy299j306l03djr8.jpg"></p></li><li><p>因而该位为“1”的概率是：</p><p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gwo9m5rofkj308d03lglh.jpg"></p></li><li><p>当我们对某个元素进行判重时，误判即这个元素对应的k 个标志位不全为1，但所有k个标志位都被置为1(<strong>这个误判率应当比实际值大，因为将判断正确的情况也算进去了。当n取无穷大时，取极限可以得到右式</strong>)：</p></li></ol><p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gwo9msjwo4j30e8043wei.jpg"></p><h3 id="变化曲线"><a href="#变化曲线" class="headerlink" title="变化曲线"></a>变化曲线</h3><p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gwo92m0f33j30fj05975h.jpg"></p><ul><li><p>p-k</p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gwo90dh14nj30la0b0ab6.jpg" alt="" style="zoom:80%;"></li><li><p>p-n</p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gwo918wnzvj30lu0b1jtl.jpg" alt="" style="zoom:80%;"></li><li><p>p-m</p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gwo91kzkvvj30lu0bctb4.jpg" alt="" style="zoom:80%;"></li></ul><h2 id="性能测试"><a href="#性能测试" class="headerlink" title="性能测试"></a>性能测试</h2><ol><li><p>引入Guava依赖</p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gwo94e9offj30iq05o0us.jpg" alt="依赖引入" style="zoom:80%;"></li><li><p>参数设置</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/**     * 预计要插入多少数据     */</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token number">100000</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * 指望的误判率     */</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">double</span> fpp <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * 布隆过滤器     */</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> BloomFilter<span class="token operator">&lt;</span>Integer<span class="token operator">&gt;</span> bloomFilter <span class="token operator">=</span> BloomFilter<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>Funnels<span class="token punctuation">.</span><span class="token function">integerFunnel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size<span class="token punctuation">,</span> fpp<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></li><li><p>测试用例</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 插入10万样本数据</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            bloomFilter<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 用另外十万个完全不一样的数据，测试误判率</span>        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> size<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size <span class="token operator">+</span> <span class="token number">100000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>bloomFilter<span class="token punctuation">.</span><span class="token function">mightContain</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>                count<span class="token operator">++</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//System.out.println(i + "误判了");</span>            <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"总共的误判数:"</span> <span class="token operator">+</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre></li><li><p>结果输出</p></li></ol><p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gwo96s7wkmj30lc060di7.jpg" alt="FPP=0.01"></p><p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gwo973fougj30kg06b76i.jpg" alt="FPP=0.03"></p><h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><ul><li>误判率能够经过FPP参数进行调节</li><li>FPP越小，须要的内存空间就越大：0.01须要900多万位数，0.03须要700多万位数。</li><li>FPP越小，集合添加数据时，就须要更多的hash函数运算更多的hash值，去存储到对应的数组下标里。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 数据结构与算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 布隆过滤器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hadoop配置总结</title>
      <link href="/2021/10/08/hadoop-pei-zhi-zong-jie/"/>
      <url>/2021/10/08/hadoop-pei-zhi-zong-jie/</url>
      
        <content type="html"><![CDATA[<h3 id="运行环境配置"><a href="#运行环境配置" class="headerlink" title="运行环境配置"></a>运行环境配置</h3><ul><li><p>配置java运行环境变量</p><pre class=" language-shell"><code class="language-shell">vim /etc/profileexport JAVA_HOME=/home/software/jdk1.8.0_181export CLASSPATH=$:CLASSPATH:$JAVA_HOME/lib/export PATH=$PATH:$JAVA_HOME/bin</code></pre></li><li><p>查看配置是否成功</p><pre class=" language-shell"><code class="language-shell">java -v</code></pre><h2 id="服务器配置"><a href="#服务器配置" class="headerlink" title="服务器配置"></a>服务器配置</h2></li><li><p>防火墙配置</p><pre class=" language-shell"><code class="language-shell"># 关闭防火墙systemctl stop firewalld.service# 开放50070端口firewall-cmd --zone=public --add-port=50070/tcp --permanent# 关闭50070端口firewall-cmd --zone=public --remove-port=50070/tcp --permanent# 刷新配置firewall-cmd --reload# 查看当前开放的端口firewall-cmd --zone=public --list-ports# 查看防火墙状态firewall-cmd --state # 查看监听端口netstat -lnpt备注：centos7默认没有 netstat 命令，需要安装 net-tools 工具，yum install -y net-tools</code></pre></li></ul><ul><li><p>网卡IP配置</p><p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gvdqj2d8x0j60np0fw45e02.jpg" alt="image.png"></p></li><li><p>配置主机名</p><pre class=" language-shell"><code class="language-shell">vim /etc/sysconfig/networkHOSTNAME=masterA</code></pre></li><li><p>修改hosts文件</p><pre class=" language-shell"><code class="language-shell">vim /etc/hosts192.168.38.133  masterA            #子网地址，最后一位不一样，网关号都是相同的192.168.38.134  masterB192.168.38.135  masterC</code></pre></li><li><p>重启</p><pre class=" language-shell"><code class="language-shell">reboot</code></pre></li></ul><h2 id="免密登录"><a href="#免密登录" class="headerlink" title="免密登录"></a>免密登录</h2><pre class=" language-shell"><code class="language-shell">ssh-keygen            #生成密钥ssh-copy-id root@masterA        #密钥拷贝ssh-copy-id root@masterBssh-copy-id root@masterC</code></pre><h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>在配置过程中主要需要对以下几个文件进行配置：core-site.xml、hdfs-site.xml、mapred-site.xml、yarn-site.xml。</p><p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gvg2fjsxs0j60lf0d3ad102.jpg" alt="image.png"></p><ul><li><p>core-site.xml</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>fs.defaultFS<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>            namenode地址        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hdfs://master:9000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hadoop.tmp.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>            配置临时目录        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/data/hadoop_repo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span></code></pre></li><li><p>hdfs-site.xml</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.secondary.http-address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>cloud01:9001<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.name.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>file://$<span class="token entity" title="{">&amp;#123;</span>hadoop.tmp.dir<span class="token entity" title="}">&amp;#125;</span>/dfs/name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.datanode.data.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>file://$<span class="token entity" title="{">&amp;#123;</span>hadoop.tmp.dir<span class="token entity" title="}">&amp;#125;</span>/dfs/data<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span></code></pre></li><li><p>yarn-site.xml</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>　　<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.aux-services<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>　　<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>mapreduce_shuffle<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>　　<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.aux-services.mapreduce.shuffle.class<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>　　<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>org.apache.hadoop.mapred.ShuffleHandler<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>　　<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>　　<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>cloud01:8132<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>　　<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.scheduler.address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>　　<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>cloud01:8130<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>　　<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.resource-tracker.address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>　　<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span> cloud01:8131<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>　　<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.admin.address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>　　<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span> cloud01:8133<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>　　<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.webapp.address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>　　<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>cloud01:8188<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span></code></pre></li><li><p>mapred-site.xml</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.framework.name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>yarn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.jobhistory.address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>cloud01:10020<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.jobhistory.webapp.address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>cloud01:19888<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span></code></pre></li></ul><p>hdfs常见端口设置</p><table><thead><tr><th>参数</th><th>描述</th><th>默认</th><th>配置文件</th><th>例子值</th></tr></thead><tbody><tr><td>fs.default.name namenode</td><td>namenode RPC交互端口</td><td>8020</td><td>core-site.xml</td><td>hdfs://master:8020/</td></tr><tr><td>dfs.http.address</td><td>NameNode web管理端口</td><td>50070</td><td>hdfs- site.xml</td><td>0.0.0.0:50070</td></tr><tr><td>dfs.datanode.address</td><td>datanode　控制端口</td><td>50010</td><td>hdfs -site.xml</td><td>0.0.0.0:50010</td></tr><tr><td>dfs.datanode.ipc.address</td><td>datanode的RPC服务器地址和端口</td><td>50020</td><td>hdfs-site.xml</td><td>0.0.0.0:50020</td></tr><tr><td>dfs.datanode.http.address</td><td>datanode的HTTP服务器和端口</td><td>50075</td><td>hdfs-site.xml</td><td>0.0.0.0:50075</td></tr></tbody></table><h2 id="命令操作"><a href="#命令操作" class="headerlink" title="命令操作"></a>命令操作</h2><ul><li><p>启动hdfs文件系统</p><pre class=" language-shell"><code class="language-shell">start-dfs.sh</code></pre></li><li><p>关闭hdfs文件系统</p><pre class=" language-shell"><code class="language-shell">stop-dfs.sh</code></pre></li><li><p>启动yarn资源管理器</p><pre class=" language-shell"><code class="language-shell">start-yarn.sh</code></pre></li><li><p>关闭yarn资源管理器</p><pre class=" language-shell"><code class="language-shell">stop-yarn.sh</code></pre></li></ul><h2 id="备注："><a href="#备注：" class="headerlink" title="备注："></a>备注：</h2><ul><li>DataNode和NameNode进程同时只能有一个工作。<ol><li>NameNode在format初始化后会生成clusterID</li><li>DataNode在启动后也会生成和NameNode一样的clusterID</li><li>当重新格式化NameNode时，会生成新的clusterID,与未删除DataNode的clusterID不一致</li></ol></li></ul><p><strong>解决方案：在格式化之前，先删除DataNode里面的信息（去temp下删除Data目录）</strong></p><p><strong>每次启动时需要将tmp目录下的current清空，以免版本不一致无法启动相关节点。</strong></p>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>线程的虚假唤醒</title>
      <link href="/2021/09/28/xian-cheng-de-xu-jia-huan-xing/"/>
      <url>/2021/09/28/xian-cheng-de-xu-jia-huan-xing/</url>
      
        <content type="html"><![CDATA[<h2 id="什么是虚假唤醒？"><a href="#什么是虚假唤醒？" class="headerlink" title="什么是虚假唤醒？"></a>什么是虚假唤醒？</h2><p>首先摘录来自维基百科的解释：</p><blockquote><p>This means that when you wait on a condition variable, the wait may (occasionally) return when no thread specifically broadcast or signaled that condition variable. Spurious wakeups may sound strange, but on some multiprocessor systems, making condition wakeup completely predictable might substantially slow all condition variable operations. The race conditions that cause spurious wakeups should be considered rare.</p></blockquote><p>虚假唤醒的意思就是当一个阻塞的线程等待某个条件变量的发生时，其他线程在唤醒了该线程后因为又有其他的线程改变了条件变量，从而导致了被唤醒的线程在执行操作时发现条件变量并不满足。</p><p>在这里举一个通俗一点的例子：有A、B、C三个线程，A线程wait()操作后进入了阻塞状态，C线程在完成操作后条件变量达到了A线程要运行的条件，因此C进行notify()操作，此时A线程被唤醒，但是恰巧此刻B线程对条件变量进行了修改操作，而当A线程执行操作时发现此时的条件变量值已经不是被唤醒时候的值。</p><h2 id="虚假唤醒实例"><a href="#虚假唤醒实例" class="headerlink" title="虚假唤醒实例"></a>虚假唤醒实例</h2><pre class=" language-java"><code class="language-java"><span class="token keyword">synchronized</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>condition does not occur<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        obj<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><p>首先用synchronized同步锁锁定资源，当条件变量未发生时则执行wait()操作，wait()操作可以细分为三步：</p><ol><li>释放锁并阻塞</li><li>等待条件cond发生</li><li>获取通知后，竞争获取锁</li></ol><p>当条件变量满足时又会唤醒阻塞的线程。</p><h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><p>在if判断语句中只会对condition变量判断一次，这样会导致条件变量还有可能会发生变化，所以应该将if语句改写为while语句进行多次判断即可。</p><pre class=" language-java"><code class="language-java"><span class="token keyword">synchronized</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>condition does not occur<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        obj<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 多线程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>多线程池化技术</title>
      <link href="/2021/09/24/duo-xian-cheng-chi-hua-ji-zhu/"/>
      <url>/2021/09/24/duo-xian-cheng-chi-hua-ji-zhu/</url>
      
        <content type="html"><![CDATA[<h2 id="什么是线程池"><a href="#什么是线程池" class="headerlink" title="什么是线程池"></a>什么是线程池</h2><p>随着集成电路技术的飞速发展，现代计算机CPU的核心数越来越多，这就为高并发编程提供了良好的硬件基础，在java中，并发编程主要是利用JUC包（java.util.concurrent）下的各种与并发有关的实现类和接口来实现。我们可以利用继承<strong>Thread</strong>类或者实现<strong>Runnable</strong>接口来创建多线程，但是随着项目场景的复杂，这种方式的缺点也逐渐凸显，使用以上的方式来编写并发程序需要自己负责线程的创建、销毁、以及线程的调度等操作。而线程池是一种利用池化思想来管理线程的技术，经常出现在一些多线程的容器软件中，比如tomcat、mysql等。</p><p>线程过多会带来额外的开销，其中包括创建销毁线程的开销、调度线程的开销等等，同时也降低了计算机的整体性能。线程池维护多个线程，等待监督管理者分配可并发执行的任务。这种做法，一方面避免了处理任务时创建销毁线程开销的代价，另一方面避免了线程数量膨胀导致的过分调度问题，保证了对内核的充分利用。</p><p>使用线程池技术有以下的优点：</p><ul><li><strong>降低资源消耗</strong>：通过池化技术重复利用已创建的线程，降低线程创建和销毁造成的损耗。</li><li><strong>提高响应速度</strong>：任务到达时，无需等待线程创建即可立即执行。</li><li><strong>提高线程的可管理性</strong>：线程是稀缺资源，如果无限制创建，不仅会消耗系统资源，还会因为线程的不合理分布导致资源调度失衡，降低系统的稳定性。使用线程池可以进行统一的分配、调优和监控。</li><li><strong>提供更多更强大的功能</strong>：线程池具备可拓展性，允许开发人员向其中增加更多的功能。比如延时定时线程池ScheduledThreadPoolExecutor，就允许任务延期执行或定期执行。</li></ul><h2 id="线程池实现"><a href="#线程池实现" class="headerlink" title="线程池实现"></a>线程池实现</h2><p>在java中线程池的实现是通过ThreadPoolExecutor实现类实现的，ThreadPoolExecutor类直接继承自AbstractExecutorService抽象类，其顶层接口为Executor接口，ThreadpoolExecutor类继承关系如图所示。</p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gvztnx2kcbj30d90euacc.jpg" alt="ThreadpoolExecutor类图" style="zoom:50%;"><h3 id="线程池工作流程"><a href="#线程池工作流程" class="headerlink" title="线程池工作流程"></a>线程池工作流程</h3><p>在线程池的内部事实上构造了这样的一个生产者-消费者模型，由一个阻塞队列作为缓冲池，线程池的运行主要分成两部分：任务管理、线程管理。任务管理部分充当生产者的角色，当任务提交后，线程池会判断该任务后续的流转：</p><p>（1）直接申请线程执行该任务；</p><p>（2）缓冲到队列中等待线程执行；</p><p>（3）拒绝该任务。线程管理部分是消费者，它们被统一维护在线程池内，根据任务请求进行线程的分配，当线程执行完任务后则会继续获取新的任务去执行，最终当线程获取不到任务的时候，线程就会被回收。</p><p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gvzu9i9a7uj310g0g80x5.jpg" alt="ThreadpoolExecutor运行流程"></p><h3 id="线程池状态管理"><a href="#线程池状态管理" class="headerlink" title="线程池状态管理"></a>线程池状态管理</h3><p>在线程池中，其基本状态分为了以下的五种状态：</p><table><thead><tr><th align="center">运行状态</th><th align="center">状态描述</th></tr></thead><tbody><tr><td align="center">RUNNING</td><td align="center">能接受新任务，也能处理阻塞队列中的任务</td></tr><tr><td align="center">SHUTDOWN</td><td align="center">关闭状态，不再处理新提交的任务，但却可以继续处理阻塞队列中的剩余任务</td></tr><tr><td align="center">STOP</td><td align="center">不接受新任务，也不处理阻塞队列中任务，中止当前进程</td></tr><tr><td align="center">TIDYING</td><td align="center">所有任务中止，有效线程数（workCount）降为0</td></tr><tr><td align="center">TERMINATED</td><td align="center">在terminated()方法执行完后进入该状态</td></tr></tbody></table><p>在线程池的实现时，将运行状态（runstate）与线程数量（workCount）通过一个变量ctl来进行管理，其中高3位保存runState，低29位保存workerCount。</p><pre class=" language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">final</span> AtomicInteger ctl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token function">ctlOf</span><span class="token punctuation">(</span>RUNNING<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>这种使用一个变量来存储两个值的方式减少了锁的开销，易于维护，同时计算有效线程数量或者获取当前线程池状态时也可以直接采用位运算的方式，相较于传统方式而言速度更快。</p><pre class=" language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">runStateOf</span><span class="token punctuation">(</span><span class="token keyword">int</span> c<span class="token punctuation">)</span>     <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span> <span class="token keyword">return</span> c <span class="token operator">&amp;</span> <span class="token operator">~</span>CAPACITY<span class="token punctuation">;</span> <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//计算当前运行状态</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">workerCountOf</span><span class="token punctuation">(</span><span class="token keyword">int</span> c<span class="token punctuation">)</span>  <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span> <span class="token keyword">return</span> c <span class="token operator">&amp;</span> CAPACITY<span class="token punctuation">;</span> <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//计算当前线程数量</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">ctlOf</span><span class="token punctuation">(</span><span class="token keyword">int</span> rs<span class="token punctuation">,</span> <span class="token keyword">int</span> wc<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span> <span class="token keyword">return</span> rs <span class="token operator">|</span> wc<span class="token punctuation">;</span> <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">//通过状态和线程数生成ctl</span></code></pre><h3 id="构造参数说明"><a href="#构造参数说明" class="headerlink" title="构造参数说明"></a>构造参数说明</h3><p>ThreadPoolExecutor完整构造方法为：</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token function">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token keyword">int</span> corePoolSize<span class="token punctuation">,</span>                              <span class="token keyword">int</span> maximumPoolSize<span class="token punctuation">,</span>                              <span class="token keyword">long</span> keepAliveTime<span class="token punctuation">,</span>                              TimeUnit unit<span class="token punctuation">,</span>                              BlockingQueue<span class="token operator">&lt;</span>Runnable<span class="token operator">&gt;</span> workQueue<span class="token punctuation">,</span>                              ThreadFactory threadFactory<span class="token punctuation">,</span>                              RejectedExecutionHandler handler<span class="token punctuation">)</span></code></pre><p>其中参数说明如下</p><table><thead><tr><th align="center">参数</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">corePoolSize</td><td align="center">指定线程池中核心线程数</td></tr><tr><td align="center">maximumPoolSize</td><td align="center">指定线程池所允许的最大线程数</td></tr><tr><td align="center">keepAliveTime</td><td align="center">当线程池的线程数量超过corePoolSize时，多余空闲线程的存活时间</td></tr><tr><td align="center">unit</td><td align="center">keepAliveTime的时间单位</td></tr><tr><td align="center">workQueue</td><td align="center">任务队列</td></tr><tr><td align="center">threadFactory</td><td align="center">线程工厂，用于创建线程</td></tr><tr><td align="center">handler</td><td align="center">拒绝策略，当任务太多时，如何进行拒绝</td></tr></tbody></table><p><strong>详细说明</strong></p><ul><li><p><strong>corePoolSize</strong> </p><p>​        核心池的大小，这个参数跟后面讲述的线程池的实现原理有非常大的关系。在创建了线程池后，默认情况下，线程池中并没有任何线程，而是等待有任务到来才创建线程去执行任务，除非调用了prestartAllCoreThreads()或者prestartCoreThread()方法，从这2个方法的名字就可以看出，是预创建线程的意思，即在没有任务到来之前就创建corePoolSize个线程或者一个线程。默认情况下，在创建了线程池后，线程池中的线程数为0，当有任务来之后，就会创建一个线程去执行任务，当线程池中的线程数目达到corePoolSize后，就会把到达的任务放到缓存队列当中。</p></li><li><p><strong>keepAliveTime</strong></p><p> ​        表示线程没有任务执行时最多保持多久时间会终止。默认情况下，只有当线程池中的线程数大于corePoolSize时，keepAliveTime才会起作用，直到线程池中的线程数不大于corePoolSize，即当线程池中的线程数大于corePoolSize时，如果一个线程空闲的时间达到keepAliveTime，则会终止，直到线程池中的线程数不超过corePoolSize。但是如果调用了allowCoreThreadTimeOut(boolean)方法，在线程池中的线程数不大于corePoolSize时，keepAliveTime参数也会起作用，直到线程池中的线程数为0。</p></li><li><p><strong>maximumPoolSize</strong></p><p>线程池最大线程数，这个参数也是一个非常重要的参数，它表示在线程池中最多能创建多少个线程。</p></li><li><p><strong>unit</strong></p><p> 参数keepAliveTime的时间单位，有7种取值，在TimeUnit类中有7种静态属性：</p><ol><li>TimeUnit.DAYS;               //天</li><li>TimeUnit.HOURS;             //小时</li><li>TimeUnit.MINUTES;           //分钟</li><li>TimeUnit.SECONDS;           //秒</li><li>TimeUnit.MILLISECONDS;      //毫秒</li><li>TimeUnit.MICROSECONDS;      //微妙</li><li>TimeUnit.NANOSECONDS;       //纳秒</li></ol></li><li><p><strong>workQueue</strong></p><p>workQueue队列一般分为三种类型：</p><ol><li>有界任务队列ArrayBlockingQueue：基于数组的先进先出队列，此队列创建时必须指定大小；</li><li>无界任务队列LinkedBlockingQueue：基于链表的先进先出队列，如果创建时没有指定此队列大小，则默认为Integer.MAX_VALUE；</li><li>直接提交队列synchronousQueue：这个队列比较特殊，它不会保存提交的任务，而是将直接新建一个线程来执行新来的任务。</li></ol></li><li><p><strong>threadFactory</strong></p><p> 执行程序创建新线程时使用的工厂，主要用来创建线程。</p></li><li><p><strong>handler</strong></p><p> 表示当拒绝处理任务时的策略，有以下四种取值：</p><ol><li>ThreadPoolExecutor.AbortPolicy:丢弃任务并抛出RejectedExecutionException异常。 </li><li>ThreadPoolExecutor.DiscardPolicy：也是丢弃任务，但是不抛出异常。 </li><li>ThreadPoolExecutor.DiscardOldestPolicy：丢弃队列最前面的任务，然后重新尝试执行任务。</li><li>ThreadPoolExecutor.CallerRunsPolicy：由调用线程处理该任务。</li></ol></li></ul><h3 id="任务调度机制"><a href="#任务调度机制" class="headerlink" title="任务调度机制"></a>任务调度机制</h3><ol><li><p>首先检测线程池运行状态，如果不是RUNNING，则直接拒绝，线程池要保证在RUNNING的状态下执行任务。</p></li><li><p>如果workerCount &lt; corePoolSize，则创建并启动一个线程来执行新提交的任务。</p></li><li><p>如果workerCount &gt;= corePoolSize，且线程池内的阻塞队列未满，则将任务添加到该阻塞队列中。</p></li><li><p>如果workerCount &gt;= corePoolSize &amp;&amp; workerCount &lt; maximumPoolSize，且线程池内的阻塞队列已满，则创建并启动一个线程来执行新提交的任务。</p></li><li><p>如果workerCount &gt;= maximumPoolSize，并且线程池内的阻塞队列已满, 则根据拒绝策略来处理该任务, 默认的处理方式是直接抛异常。</p></li></ol><h3 id="拒绝策略"><a href="#拒绝策略" class="headerlink" title="拒绝策略"></a>拒绝策略</h3><p>当线程池的任务缓冲队列已满，并且线程池中的线程个数达到maximumPoolSize时需要拒绝掉该任务，任务的拒绝策略主要有以下的几种。</p><p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gvzwpftqlpj316u0dztfk.jpg" alt="四种拒绝策略"></p><h3 id="阻塞队列类型"><a href="#阻塞队列类型" class="headerlink" title="阻塞队列类型"></a>阻塞队列类型</h3><p>其中前两种阻塞队列比较常用。</p><p><img src="http://tva1.sinaimg.cn/large/006SFsamly1gvzuxbh79dj30zy0fu7c1.jpg" alt="阻塞队列分类"></p><h2 id="四种常用线程池"><a href="#四种常用线程池" class="headerlink" title="四种常用线程池"></a>四种常用线程池</h2><p>Java通过Executors提供四种线程池，底层均是由ThreadPoolExecutor实现的，分别为：</p><ul><li><p><strong>newCachedThreadPool</strong></p><p>创建一个可缓存线程池，如果线程池长度超过处理需要，可灵活回收空闲线程，若无可回收，则新建线程。</p><pre class=" language-java"><code class="language-java">ExecutorService cachedThreadPool <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>      <span class="token keyword">final</span> <span class="token keyword">int</span> index <span class="token operator">=</span> i<span class="token punctuation">;</span>      <span class="token keyword">try</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>          Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>index <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>          e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>      cachedThreadPool<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>          <span class="token annotation punctuation">@Override</span>          <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>              System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>      <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre></li><li><p><strong>newFixedThreadPool</strong></p><p>创建一个定长线程池，可控制线程最大并发数，超出的线程会在队列中等待。</p><pre class=" language-java"><code class="language-java">ExecutorService fixedThreadPool <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>      <span class="token keyword">final</span> <span class="token keyword">int</span> index <span class="token operator">=</span> i<span class="token punctuation">;</span>      fixedThreadPool<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>              <span class="token annotation punctuation">@Override</span>          <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>              <span class="token keyword">try</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>                  System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>                  Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>                  <span class="token comment" spellcheck="true">// TODO Auto-generated catch block  </span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>          <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>      <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>  </code></pre></li><li><p><strong>newScheduledThreadPool</strong></p><p>创建一个定长线程池，支持定时及周期性任务执行。</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//表示延迟3秒执行。</span>ScheduledExecutorService scheduledThreadPool <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newScheduledThreadPool</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  scheduledThreadPool<span class="token punctuation">.</span><span class="token function">schedule</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token annotation punctuation">@Override</span>      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"delay 3 seconds"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//表示延迟1秒后每3秒执行一次。</span>scheduledThreadPool<span class="token punctuation">.</span><span class="token function">scheduleAtFixedRate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token annotation punctuation">@Override</span>      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>          System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"delay 1 seconds, and excute every 3 seconds"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span>  </code></pre></li><li><p><strong>newSingleThreadPoolExecutor</strong></p><p>创建一个单线程化的线程池，它只会用唯一的工作线程来执行任务，保证所有任务按照指定顺序(FIFO, LIFO, 优先级)执行。</p><pre class=" language-java"><code class="language-java">ExecutorService singleThreadExecutor <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newSingleThreadExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>      <span class="token keyword">final</span> <span class="token keyword">int</span> index <span class="token operator">=</span> i<span class="token punctuation">;</span>      singleThreadExecutor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token annotation punctuation">@Override</span>          <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>              <span class="token keyword">try</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>                  System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>                  Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>                  <span class="token comment" spellcheck="true">// TODO Auto-generated catch block  </span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>          <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>      <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>  </code></pre></li></ul><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><blockquote><p>java线程池实现原理及在美团业务中的实践 <a href="https://tech.meituan.com/2020/04/02/java-pooling-pratice-in-meituan.html">https://tech.meituan.com/2020/04/02/java-pooling-pratice-in-meituan.html</a> </p><p>JAVA线程池，ThreadPoolExecutor实现的四种线程池<a href="https://blog.csdn.net/a78270528/article/details/79881850">https://blog.csdn.net/a78270528/article/details/79881850</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 多线程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浅谈docker</title>
      <link href="/2021/07/14/qian-tan-docker/"/>
      <url>/2021/07/14/qian-tan-docker/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在软件开发过程中一个很重要的步骤就是<strong>部署环境</strong>，java应用需要布置java环境，python应用需要布置python环境，同时还需要配置系统环境变量与各种库的安装，耗时耗力。而且最可能出现的情况就是一个程序在这台机器上可以跑，放在另外一台机器上就不可以跑了，那么解决这种办法的方式是把环境和应用打包在一起，也就是带环境安装。</p><h2 id="虚拟机"><a href="#虚拟机" class="headerlink" title="虚拟机"></a>虚拟机</h2><p>虚拟机是带环境安装的一种方案，它的本质原理就是在操作系统上运行操作系统，一切操作都是基于你内层的操作系统进行，可以把虚拟机看作是一个文件，不需要时直接删除即可。但是这种方案会带来以下几个缺点：</p><ul><li><p><strong>资源占用多</strong></p><p>虚拟机会虚拟化出一套硬件设备，这就意味着消耗了计算机资源，即使虚拟机中没有程序运行还是会占用这些资源，使得其他程序不能够利用。</p></li><li><p><strong>冗余步骤多</strong></p><p>虚拟机是完整的操作系统，系统级别的操作无法跳过，比如每次使用前都必须进行用户登录。</p></li><li><p><strong>启动慢</strong></p><p>由于虚拟机需要在硬件层面进行硬件资源的申请与分配，这就导致了较为耗时，可能要等一会虚拟机才能真正启动起来。</p></li></ul><p>由于虚拟机存在以上的缺点，所以又出现了：<strong>Linux容器</strong>。</p><h2 id="Linux容器"><a href="#Linux容器" class="headerlink" title="Linux容器"></a>Linux容器</h2><p>容器与虚拟机不同的是不是去模拟一个完整的操作系统，而是在软件层面对进程进行隔离，相当于在进程上套一层，因而对于容器里的进程来说，它所接触到的资源都是虚拟的，从而实现与底层系统的隔离。容器有以下优点：</p><ul><li><p><strong>启动快</strong></p><p>启动容器里的应用可以看作为启动操作系统里的进程，那么启动进程的消耗肯定是比虚拟化一个os的消耗要小的，所以容器里启动一个应用要比虚拟机快得多。</p></li><li><p><strong>资源占用少</strong></p><p>由于容器是在软件层面进行虚拟，所以它只占用它所需要的资源，而虚拟机因为是一个完整的操作系统，所以需要占用各项资源，同时，多个容器之间也是可以共享资源的。</p></li><li><p><strong>体积小</strong></p><p>容器只是需要它所需要的组件即可，并可以对组件进行<strong>复用</strong>，而虚拟机需要包含完整的操作系统，所以占用体积较大。</p></li><li><p><strong>便于迁移</strong></p><p>有了容器之后可对容器直接打包，在另外一台机器上便可运行，不需要进行繁杂的环境配置。</p></li></ul><h2 id="Docker是什么"><a href="#Docker是什么" class="headerlink" title="Docker是什么"></a>Docker是什么</h2><p>Docker本质就是属于容器的一种封装，传统的镜像部署方式大都是通过shell脚本的方式直接将镜像运行在服务器操作系统层或者虚拟机层，但是带来的一个问题是虚拟机每次需要在硬件层面进行虚拟化操作，而容器不需要进行硬件虚拟以及运行完整操作系统等额外开销。Docker 对系统资源的利用率更高。无论是应用执行速度、内存损耗或者文件存储速度，都要比传统虚拟机技术更高效。</p><p>简而言之，Docker提供了一种更为聪明的方式：<strong>通过容器打包应用，解耦应用和运行平台</strong>。</p><p>另外，通过使用Docker还可以进行持续集成与持续交付（CI/CD）操作，应用进行功能升级或错误补丁时直接可以通过更新镜像的方式进行，从而简化了开发的生命周期。</p><h2 id="Docker构成"><a href="#Docker构成" class="headerlink" title="Docker构成"></a>Docker构成</h2><ul><li><p>镜像：docker镜像可以看作是一个应用包，类似于一个软件包。</p></li><li><p>容器：将镜像软件启动后就形成了容器，镜像是静态的，容器是动态的，容器可以被创建、启动、停止、删除等。</p></li><li><p>仓库：仓库顾名思义就是保管物品的地方，食物仓库保管食物，那么Docker仓库保管的就是镜像。</p><p><img src="https://www.runoob.com/wp-content/uploads/2016/04/576507-docker1.png" alt="Docker架构图"></p></li></ul><table><thead><tr><th>Docker 镜像(Images)</th><th>Docker 镜像是用于创建 Docker 容器的模板，比如 Ubuntu 系统。</th></tr></thead><tbody><tr><td>Docker 容器(Container)</td><td>容器是独立运行的一个或一组应用，是镜像运行时的实体。</td></tr><tr><td>Docker 客户端(Client)</td><td>Docker 客户端通过命令行或者其他工具使用 Docker SDK (<a href="https://docs.docker.com/develop/sdk/">https://docs.docker.com/develop/sdk/</a>) 与 Docker 的守护进程通信。</td></tr><tr><td>Docker 主机(Host)</td><td>一个物理或者虚拟的机器用于执行 Docker 守护进程和容器。</td></tr><tr><td>Docker Registry</td><td>Docker 仓库用来保存镜像，可以理解为代码控制中的代码仓库。Docker Hub(<a href="https://hub.docker.com/">https://hub.docker.com</a>) 提供了庞大的镜像集合供使用。一个 Docker Registry 中可以包含多个仓库（Repository）；每个仓库可以包含多个标签（Tag）；每个标签对应一个镜像。通常，一个仓库会包含同一个软件不同版本的镜像，而标签就常用于对应该软件的各个版本。我们可以通过 <strong>&lt;仓库名&gt;:&lt;标签&gt;</strong> 的格式来指定具体是这个软件哪个版本的镜像。如果不给出标签，将以 <strong>latest</strong> 作为默认标签。</td></tr><tr><td>Docker Machine</td><td>Docker Machine是一个简化Docker安装的命令行工具，通过一个简单的命令行即可在相应的平台上安装Docker，比如VirtualBox、 Digital Ocean、Microsoft Azure。</td></tr></tbody></table><h2 id="安装方式"><a href="#安装方式" class="headerlink" title="安装方式"></a>安装方式</h2><p>这里以Centos7机器为例进行安装</p><h3 id="使用官方脚本安装"><a href="#使用官方脚本安装" class="headerlink" title="使用官方脚本安装"></a>使用官方脚本安装</h3><pre class=" language-shell"><code class="language-shell">curl -fsSL https://get.docker.com | bash -s docker --mirror aliyun</code></pre><p>也可以使用国内 daocloud 一键安装命令</p><pre class=" language-shell"><code class="language-shell">curl -sSL https://get.daocloud.io/docker | sh</code></pre><h3 id="手动安装"><a href="#手动安装" class="headerlink" title="手动安装"></a>手动安装</h3><p>准备工作：</p><pre class=" language-shell"><code class="language-shell"># 安装C环境yum -y install gccyum -y install gcc-c++# 卸载旧版本yum remove docker \ docker-client \ docker-client-latest \ docker-common \ docker-latest \ docker-latest-logrotate \ docker-logrotate \ docker-selinux \ docker-engine-selinux \ docker-engine</code></pre><p>正式安装：</p><pre class=" language-shell"><code class="language-shell"># 安装依赖包yum install -y yum-utils device-mapper-persistent-data lvm2#设置stable镜像仓库yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo#更新yum软件包索引yum makecache fast#列出所有版本yum list docker-ce.x86_64  --showduplicates | sort -r    #从高到低列出Docker-ce的版本# 安装指定版本（将version-string替换为要安装的版本号）yum install docker-ce-<version_string> docker-ce-cli-<version_string> containerd.io# 安装最新版本yum -y install docker-ce# 检查docker是否安装成功docker info或者docker version</version_string></version_string></code></pre><h3 id="启动docker"><a href="#启动docker" class="headerlink" title="启动docker"></a>启动docker</h3><pre class=" language-shell"><code class="language-shell"># service命令的写法sudo service docker start# systemctl命令的写法systemctl start docker</code></pre><h3 id="配置镜像加速"><a href="#配置镜像加速" class="headerlink" title="配置镜像加速"></a>配置镜像加速</h3><p>由于Docker仓库位于国外，所以从国内拉取镜像资源常常会出现网络报错的情况，那么就需要配置国内的镜像仓库提高拉取速度，对于使用 systemd 的系统，可通过在 /etc/docker/daemon.json 中写入如下内容。</p><pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token property">"registry-mirrors"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"国内仓库地址"</span><span class="token punctuation">]</span>&amp;#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><p>国内常用docker仓库地址有：</p><ul><li>中科大：<strong><a href="https://docker.mirrors.ustc.edu.cn/">https://docker.mirrors.ustc.edu.cn/</a></strong></li><li>网易：<strong><a href="https://hub-mirror.c.163.com/">https://hub-mirror.c.163.com/</a></strong></li><li>阿里云：<strong>https://&lt;你的ID&gt;.mirror.aliyuncs.com</strong></li></ul><p><strong>备注：</strong>阿里云镜像获取地址：<a href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors">https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors</a></p><p>完成以上操作后重启docker</p><pre class=" language-shell"><code class="language-shell"> sudo systemctl daemon-reload sudo systemctl restart docker</code></pre><h2 id="Docker基本操作"><a href="#Docker基本操作" class="headerlink" title="Docker基本操作"></a>Docker基本操作</h2><pre class=" language-shell"><code class="language-shell"># 查看docker命令docker</code></pre><img src="http://ww1.sinaimg.cn/large/006SFsamly1gshxmiqcu5j318m11hkis.jpg" style="zoom:50%;"><pre class=" language-shell"><code class="language-shell"># 列出所有docker镜像docker images</code></pre><p><img src="http://ww1.sinaimg.cn/large/006SFsamly1gsl0irrhw8j30p104b425.jpg"></p><pre class=" language-shell"><code class="language-shell"># 列出正在运行的镜像docker ps</code></pre><p><img src="http://ww1.sinaimg.cn/large/006SFsamly1gsl0kw3tpnj31bs043gq6.jpg"></p><pre class=" language-shell"><code class="language-shell"># 搜索某个镜像docker search "image-name"</code></pre><p><img src="http://ww1.sinaimg.cn/large/006SFsamly1gsl0m4lvw8j315t0lyx5m.jpg"></p><pre class=" language-shell"><code class="language-shell"># 安装镜像docker pull "image-name"# 这里以安装运行mysql镜像5.6版本为例docker pull mysql:5.6</code></pre><p><img src="http://ww1.sinaimg.cn/large/006SFsamly1gsl1kjjv8gj30t90d4qbp.jpg"></p><pre class=" language-shell"><code class="language-shell"># 启动容器docker run -p 3306:3306 --name mysql -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.6-p        (内网端口:外网端口)--name        容器名称-e        设置容器密码-d        服务方式启动#查看当前容器docker container ls</code></pre><p><img src="http://ww1.sinaimg.cn/large/006SFsamly1gslb81d0evj31ky094gxf.jpg"></p><pre class=" language-shell"><code class="language-shell"># 以交互模式运行mysql镜像docker run -it mysql bash# 进入mysqlmysql -uroot -p123456# 退出当前交互模式exit</code></pre><p><img src="http://ww1.sinaimg.cn/large/006SFsamly1gslbapumkhj30uz0l1gwv.jpg"></p><pre class=" language-shell"><code class="language-shell"># 停止容器运行docker container stop mysql# 删除容器docker container rm mysql</code></pre><p><img src="http://ww1.sinaimg.cn/large/006SFsamly1gslbduh2iij30nd038wgb.jpg"></p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><blockquote><p>菜鸟教程（Docker）</p><p><a href="https://www.runoob.com/docker/docker-architecture.html">https://www.runoob.com/docker/docker-architecture.html</a></p><p>阮一峰的网络日志</p><p><a href="https://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html">https://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 虚拟化 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 容器 </tag>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>房源推荐系统</title>
      <link href="/2021/07/05/fang-yuan-tui-jian-xi-tong/"/>
      <url>/2021/07/05/fang-yuan-tui-jian-xi-tong/</url>
      
        <content type="html"><![CDATA[<h2 id="项目介绍"><a href="#项目介绍" class="headerlink" title="项目介绍"></a>项目介绍</h2><p>本项目为本科期间的毕业设计，因为之前有做过房源网站的爬虫与数据分析，所以当时希望在此基础上做一些功能的扩充，于是就选择了去实现一个基于内容相似度的房源推荐系统。本系统前端、后端、算法部分皆为本人一人完成，由于个人能力有限，有不完善的地方还请不吝指教。</p><h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><p>推荐系统是一种信息过滤系统，旨在解决人们所面临着的信息冗余、过载的问题。 随着互联网上房源信息越来越多，人们从大量的房产信息中找到自己需要的信息也变得 越来越困难，传统的搜索引擎具有明确的目的性，但需要用户提供明确的信息，而推荐 系统可以发掘长尾信息，主动给用户推荐满足用户兴趣的信息。基于内容推荐算法的房源推荐系统利用房源的面积、户型、价格等属性字段去计算不同房源之间的相似度，从 而返回某个房源的 TopN 相似度列表完成推荐。</p><h2 id="总体架构"><a href="#总体架构" class="headerlink" title="总体架构"></a>总体架构</h2><img src="http://ww1.sinaimg.cn/large/006SFsamly1gs3lx5buqnj30nu0ktab2.jpg" style="zoom:60%;"><p>本系统主要分为三大模块：展示层基于 微信小程序构建，方便快捷；服务层利用 Python 实现余弦相似度算法计算房源之间相 似度，再搭建远程过程调用服务，服务端对外则使用 SpringBoot 框架搭建 Restful API 接口；数据层以 Mysql 数据库作为支撑，存储关系型数据，同时使用 Redis 缓存作为辅 助来存储推荐结果，从而提高推荐系统对于前端的响应速度。另外，在项目前期利用爬 虫程序爬取房源信息，并进行了数据清洗、去重等工作，从而为数据的特征提取、处理 打下了一个良好的基础。开发工具主要使用了 JetBrains 公司开发的 IntelliJ IDEA 与 Pycharm、微信开发者工具、PostMan 接口测试工具。</p><h2 id="展示层"><a href="#展示层" class="headerlink" title="展示层"></a>展示层</h2><h3 id="微信小程序"><a href="#微信小程序" class="headerlink" title="微信小程序"></a>微信小程序</h3><h4 id="小程序架构图"><a href="#小程序架构图" class="headerlink" title="小程序架构图"></a>小程序架构图</h4><img src="http://ww1.sinaimg.cn/large/006SFsamly1gs3ljo14qzj30mt0f2gnl.jpg" style="zoom:60%;"><h4 id="页面结构"><a href="#页面结构" class="headerlink" title="页面结构"></a>页面结构</h4><img src="http://ww1.sinaimg.cn/large/006SFsamly1gs3lma1xldj30do09a74c.jpg" style="zoom:90%;"><p>小程序的项目结构可大致分为第三方 UI 组件目录、页面目录、和小程序全局 配置文件。小程序开发引用到了 iView Weapp 组件库与 Wux App 组件库，这些都 是小程序开发中比较常用的第三方 UI 组件库；页面总共分为了七个页面，其中有 些页面进行了多次代码复用 ；小程序全局配置文件主要是注册小程序的生命周 期函数、全局样式、Tab 页面注册及负责一些小程序初始化的逻辑。</p><h2 id="服务层"><a href="#服务层" class="headerlink" title="服务层"></a>服务层</h2><h3 id="推荐算法"><a href="#推荐算法" class="headerlink" title="推荐算法"></a>推荐算法</h3><ol><li><p>数据预处理</p><p>原始的文本数据不能直接参与运算，需要对其进行一系列的数据处理才能满足参与算法运算的要求。同时，数据预处理的好坏直接决定了系统最终生成的推荐结果的好坏，因此数据预处理阶段主要是原始数据进行清洗、去重、编码、区间放缩等处理，使之数据格式能够满足算法可以直接进行向量计算的格式。</p><p>原始文本数据如下：</p><img src="http://ww1.sinaimg.cn/large/006SFsamly1gs3ohwititj30lw0u1754.jpg" style="zoom:60%;"></li><li><p>One-Hot编码</p><p>清洗、去重等操作一般在爬取数据时同步进行，而在完成这两部操作后则开始进行独热编码（One-Hot），独热编码又称一位有效编码。其方法是使用 N位状态寄存器来对N个状态进行编码，每个状态都有它独立的寄存器位，并且在任意时候，其中只有一位有效。One-Hot编码的核心思想是将分类的变量值作为二进制向量进行表示。例如属性字段“ori”在进行One-Hot编码后映射为四个分量，四个分量有且仅有一个值置为1，即任何时候只有一位有效。</p><p>“朝向” 字段独热编码结果：</p><img src="http://ww1.sinaimg.cn/large/006SFsamly1gs3ojop58vj30ig0713ye.jpg" style="zoom:80%;"></li><li><p>0-1标准化</p><p>0-1标准化也称为离差标准化，它是对原始数据进行变换，使之落到[0,1]区间范围。房源数据中比如“价格”字段的数值与“面积”字段的数值会相差较大，若不经过量化处理直接参与运算，则容易导致计算结果偏差较大，因而需要标准化处理。标准化处理的具体过程是使用某个数值与该字段最小值的差除以该字段的区间长度，相当于进行了一次区间放缩。</p><p>区间放缩公式：</p><p><img src="http://ww1.sinaimg.cn/mw690/006SFsamly1gs4526q9bwj305l01y0si.jpg"></p><p>数据标准化结果：</p><img src="http://ww1.sinaimg.cn/large/006SFsamly1gs3on84hx3j314j0khq60.jpg" style="zoom:50%;"></li><li><p>余弦相似度算法</p><p>余弦相似度算法是一种常见的计算物品之间相似度的算法，其核心思想是对两个向量相乘再除以两个向量的模长之积，其比较适合高维度的数据计算。余弦相似度的结果小于1，越接近1代表余弦角度越小，即两个物品向量越相似；反之，数值越远离1，则说明两个向量之间的相关性较低。</p><p>余弦相似度公式为：</p><p><img src="http://ww1.sinaimg.cn/large/006SFsamly1gs3opwyzunj30c2035a9x.jpg"></p><p>房源信息一般信息量比较大，包含价格、面积、户型、装修类型等多个属性信息，本系统在计算房源之间相似度的时候，为提高相似度的准确性，使用了25个属性字段来作为房源向量分量参与计算。</p></li></ol><pre class=" language-python"><code class="language-python">usecols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">,</span> <span class="token string">'city'</span><span class="token punctuation">,</span> <span class="token string">'rental_method'</span><span class="token punctuation">,</span> <span class="token string">'house_type'</span><span class="token punctuation">,</span> <span class="token string">'room_type'</span><span class="token punctuation">,</span> <span class="token string">'area_size'</span><span class="token punctuation">,</span>                                    <span class="token string">'decorate_type'</span><span class="token punctuation">,</span> <span class="token string">'ori'</span><span class="token punctuation">,</span>                                    <span class="token string">'has_heat'</span><span class="token punctuation">,</span> <span class="token string">'has_tv'</span><span class="token punctuation">,</span> <span class="token string">'has_refrigerator'</span><span class="token punctuation">,</span> <span class="token string">'has_washing_machine'</span><span class="token punctuation">,</span>                                    <span class="token string">'has_balcony'</span><span class="token punctuation">,</span> <span class="token string">'has_cook'</span><span class="token punctuation">,</span> <span class="token string">'has_air_conditioner'</span><span class="token punctuation">,</span>                                    <span class="token string">'has_bed'</span><span class="token punctuation">,</span> <span class="token string">'has_sofa'</span><span class="token punctuation">,</span> <span class="token string">'has_wardrobe'</span><span class="token punctuation">,</span> <span class="token string">'has_toilet'</span><span class="token punctuation">,</span> <span class="token string">'has_smart_lock'</span><span class="token punctuation">,</span>                                    <span class="token string">'has_ventilator'</span><span class="token punctuation">,</span>                                    <span class="token string">'has_gas_stove'</span><span class="token punctuation">,</span> <span class="token string">'has_wifi'</span><span class="token punctuation">,</span> <span class="token string">'room_num'</span><span class="token punctuation">,</span> <span class="token string">'bath_num'</span><span class="token punctuation">,</span> <span class="token string">'halls_num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p>在具体的处理计算过程中先根据“城市”属性提取出同一城市的所有房源，然后再使用Pandas模块下的get_dummies方法进行独热编码，使用sklearn.preprocessing模块下的MinMaxScaler进行数据标准化处理。在完成所有的数据预处理过程后使用sklearn.metrics.pairwise模块下的cosine_similarity进行余弦相似度的计算，最终生成相似度矩阵，然后再对相似度矩阵进行排序，查找出TopN相似度列表，最终返回房源ID组成的列表。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">calculateSimilarity</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment" spellcheck="true">### 内容相似度计算核心代码 ###</span>    <span class="token comment" spellcheck="true"># 筛选出特定城市的房源</span>    city_room <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'city'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span>self<span class="token punctuation">.</span>city<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># 重置索引</span>    city_room<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 查找room_id所在索引位置</span>    room_index <span class="token operator">=</span> city_room<span class="token punctuation">[</span>city_room<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">==</span> self<span class="token punctuation">.</span>room_id<span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>room_index<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 独热编码</span>    code_result <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>city_room<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 映射到0-1区间</span>    standard_result <span class="token operator">=</span> MinMaxScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>code_result<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'数据预处理结果：'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>standard_result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 余弦相似度计算，生成相似度矩阵</span>    cosine_result <span class="token operator">=</span> cosine_similarity<span class="token punctuation">(</span>standard_result<span class="token punctuation">)</span>    index_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> row_index <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>cosine_result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> row_index <span class="token operator">==</span> room_index<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            similarity_list <span class="token operator">=</span> cosine_result<span class="token punctuation">[</span>row_index<span class="token punctuation">]</span>            <span class="token comment" spellcheck="true"># 返回前五大元素所在索引值</span>            index_list <span class="token operator">=</span> heapq<span class="token punctuation">.</span>nlargest<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>similarity_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> similarity_list<span class="token punctuation">.</span>__getitem__<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># print('最大元素的索引值为：')</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>index_list<span class="token punctuation">)</span>            <span class="token keyword">break</span>    room_id_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># 查找索引值列表对应的room_id</span>    <span class="token keyword">for</span> item <span class="token keyword">in</span> index_list<span class="token punctuation">:</span>        room_id_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>city_room<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 去除相似度最高（本身）元素</span>    <span class="token keyword">del</span> room_id_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>room_id_list<span class="token punctuation">)</span>    <span class="token keyword">return</span> room_id_list</code></pre><p>房源相似度矩阵：</p><img src="http://ww1.sinaimg.cn/large/006SFsamly1gs3ow6hookj31aw0j8n1a.jpg" style="zoom:80%;"><h3 id="RPC服务"><a href="#RPC服务" class="headerlink" title="RPC服务"></a>RPC服务</h3><p>在完成上一步的推荐算法搭建后需要搭建对外服务的接口，此时共有两种方法可以选择：可搭建基于HTTP协议的API接口，也可搭建基于TCP协议的远程过程调用（Remote Procedure Call）服务。由于推荐系统需要实时处理大量数据来推送出去，基于HTTP协议的Restful形式的API接口需要传送HTTP头部报文，比较耗费性能，而基于TCP协议的RPC服务则无需封装头部报文，更加高效。</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 创建RPC服务</span><span class="token keyword">def</span> <span class="token function">service</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> func_lst<span class="token punctuation">,</span> v1<span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>svr <span class="token operator">=</span> ThreadXMLRPCServer<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>ip<span class="token punctuation">,</span> self<span class="token punctuation">.</span>port<span class="token punctuation">)</span><span class="token punctuation">,</span> allow_none<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> func <span class="token keyword">in</span> func_lst<span class="token punctuation">:</span>        self<span class="token punctuation">.</span>svr<span class="token punctuation">.</span>register_function<span class="token punctuation">(</span>func<span class="token punctuation">)</span>    self<span class="token punctuation">.</span>svr<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span>poll_interval<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span></code></pre><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 启动RPC服务</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'RPC服务已启动'</span><span class="token punctuation">)</span>    r <span class="token operator">=</span> RPCServer<span class="token punctuation">(</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> <span class="token string">'8061'</span><span class="token punctuation">)</span>    r<span class="token punctuation">.</span>service<span class="token punctuation">(</span><span class="token punctuation">[</span>get_similarity_list<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 这里仅仅载入get_similarity_list函数</span></code></pre><h3 id="SpringBoot微服务"><a href="#SpringBoot微服务" class="headerlink" title="SpringBoot微服务"></a>SpringBoot微服务</h3><p>本系统中使用到的Spring Boot微服务框架主要是为搭建Restful形式的API接口，来为小程序端提供数据传输能力。项目大致分为了controller层、service层、dao层，pojo层，controller层作为请求控制器负责请求的接受并调用相应的service方法将处理结果响应给前端；service层是具体的业务逻辑，负责实现相应的业务操作；dao层是数据持久层，专注于与数据库的交互；而pojo层则存放的是具体的实体类，提供基本的getter与setter方法。</p><ul><li><p>RoomDataController（房源控制器类）</p><ol><li><p>根据关键字检索房源</p></li><li><p> 根据ID获取房源信息</p></li><li><p> 根据城市、租赁类型、装修类型等条件筛选房源</p></li><li><p> 获取某个房源的TOP 5相似房源列表</p></li></ol></li><li><p>UserController（用户控制器类）</p><ol><li><p> 用户注册</p></li><li><p> 用户登陆</p></li><li><p> 添加房源到用户收藏</p></li><li><p> 获取用户收藏</p></li><li><p> 删除收藏的房源</p></li><li><p> 添加用户浏览记录</p></li><li><p> 查看用户浏览记录</p></li></ol></li></ul><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*application.properties配置*/</span>server<span class="token punctuation">.</span>port<span class="token operator">=</span><span class="token number">80</span>mybatis<span class="token punctuation">.</span>type<span class="token operator">-</span>aliases<span class="token operator">-</span><span class="token keyword">package</span><span class="token operator">=</span>com<span class="token punctuation">.</span>oliver<span class="token punctuation">.</span>pojomybatis<span class="token punctuation">.</span>mapper<span class="token operator">-</span>locations<span class="token operator">=</span>classpath<span class="token operator">:</span>mappers<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>xml#设置api公共前缀server<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>context<span class="token operator">-</span>path<span class="token operator">=</span><span class="token operator">/</span>api#实体对象属性为null值时自动清除spring<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span><span class="token keyword">default</span><span class="token operator">-</span>property<span class="token operator">-</span>inclusion<span class="token operator">=</span>non_null#mybatis设置驼峰命名mybatis<span class="token punctuation">.</span>configuration<span class="token punctuation">.</span>map<span class="token operator">-</span>underscore<span class="token operator">-</span>to<span class="token operator">-</span>camel<span class="token operator">-</span><span class="token keyword">case</span><span class="token operator">=</span><span class="token boolean">true</span> spring<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>host<span class="token operator">=</span><span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">0.1</span>#Redis服务器连接端口spring<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>port<span class="token operator">=</span><span class="token number">6379</span>#Redis服务器连接密码（默认为空）spring<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>password<span class="token operator">=</span>#连接池最大连接数（使用负值表示没有限制）spring<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>pool<span class="token punctuation">.</span>max<span class="token operator">-</span>active<span class="token operator">=</span><span class="token number">8</span>#连接池最大阻塞等待时间（使用负值表示没有限制）spring<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>pool<span class="token punctuation">.</span>max<span class="token operator">-</span>wait<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span>#连接池中的最大空闲连接spring<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>pool<span class="token punctuation">.</span>max<span class="token operator">-</span>idle<span class="token operator">=</span><span class="token number">8</span>#连接池中的最小空闲连接spring<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>pool<span class="token punctuation">.</span>min<span class="token operator">-</span>idle<span class="token operator">=</span><span class="token number">0</span>#连接超时时间（毫秒）spring<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>timeout<span class="token operator">=</span><span class="token number">30000</span></code></pre><h2 id="数据层"><a href="#数据层" class="headerlink" title="数据层"></a>数据层</h2><h3 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h3><p>主要利用MySQL来存储房源数据、用户个人数据、用户收藏数据、用户浏览记录，数据库存储引擎选用的是InnoDB，编码为UTF-8。</p><p>在SpringBoot项目中的application.yaml中进行数据源的配置，其中需要设置数据库连接URL，数据库用户名、数据库密码，数据库连接驱动（一般推荐使用com.mysql.cj.jdbc.Driver）。同时，为防止日期格式等出现错误或乱码问题还需要设置时区与日期格式。</p><pre class=" language-java"><code class="language-java"># 数据源配置 datasource<span class="token operator">:</span>    url<span class="token operator">:</span> jdbc<span class="token operator">:</span>mysql<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">3306</span><span class="token operator">/</span>house<span class="token operator">?</span>useSSL<span class="token operator">=</span><span class="token boolean">false</span><span class="token operator">&amp;</span>useLegacyDatetimeCode<span class="token operator">=</span><span class="token boolean">false</span><span class="token operator">&amp;</span>serverTimezone<span class="token operator">=</span>Asia<span class="token operator">/</span>Shanghai    username<span class="token operator">:</span> root    password<span class="token operator">:</span> <span class="token number">123456</span>    #type<span class="token operator">:</span> com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>druid<span class="token punctuation">.</span>pool<span class="token punctuation">.</span>DruidDataSource    driver<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">-</span>name<span class="token operator">:</span> com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>cj<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver  jackson<span class="token operator">:</span>    date<span class="token operator">-</span>format<span class="token operator">:</span> yyyy<span class="token operator">-</span>MM<span class="token operator">-</span>dd HH<span class="token operator">:</span>mm<span class="token operator">:</span>ss    time<span class="token operator">-</span>zone<span class="token operator">:</span> GMT<span class="token operator">+</span><span class="token number">8</span></code></pre><p>数据库E-R图：</p><p><img src="http://ww1.sinaimg.cn/mw690/006SFsamly1gs44hsvlkej30cu0sm74k.jpg" alt="E-R图"></p><h3 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h3><p>在未引入Redis缓存的情况下若前端小程序加载刚刚加载过的房源详情页面时服务端会重新调用推荐算法模型生成推荐列表，这样在请求量较少的时候系统还可以承载，若请求量增大时，系统将会耗费大量的时间在CPU运算处理任务上，请求响应时间将会大大增加。而引入Redis缓存中间件后则可以使得不必每次都去调用算法模型来生成推荐列表，只需要先在Redis缓存中查找请求的房源ID是否已经存在于Redis缓存之中，若存在时则直接从房源列表中取出推荐房源列表并返回；若未存在时则将房源ID传入算法模型进行处理，生成推荐列表后返回前端。</p><p>SpringBoot项目在启动时会根据Redis配置类来配置Redis，包括设置缓存过期时间、序列化与反序列化机制等。</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*Redis配置*/</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisConfig</span> <span class="token keyword">extends</span> <span class="token class-name">CachingConfigurerSupport</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> StringRedisSerializer STRING_SERIALIZER <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> GenericJackson2JsonRedisSerializer JACKSON__SERIALIZER <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GenericJackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * 缓存管理配置     * @param redisConnectionFactory     * @return     */</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> CacheManager <span class="token function">cacheManager</span><span class="token punctuation">(</span>RedisConnectionFactory redisConnectionFactory<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//设置缓存过期时间</span>        RedisCacheConfiguration redisCacheCfg<span class="token operator">=</span>RedisCacheConfiguration<span class="token punctuation">.</span><span class="token function">defaultCacheConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">entryTtl</span><span class="token punctuation">(</span>Duration<span class="token punctuation">.</span><span class="token function">ofMinutes</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">serializeKeysWith</span><span class="token punctuation">(</span>RedisSerializationContext<span class="token punctuation">.</span>SerializationPair<span class="token punctuation">.</span><span class="token function">fromSerializer</span><span class="token punctuation">(</span>STRING_SERIALIZER<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">serializeValuesWith</span><span class="token punctuation">(</span>RedisSerializationContext<span class="token punctuation">.</span>SerializationPair<span class="token punctuation">.</span><span class="token function">fromSerializer</span><span class="token punctuation">(</span>JACKSON__SERIALIZER<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> RedisCacheManager<span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span>RedisCacheWriter<span class="token punctuation">.</span><span class="token function">nonLockingRedisCacheWriter</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">cacheDefaults</span><span class="token punctuation">(</span>redisCacheCfg<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * 序列化与反序列化配置     * @param factory     * @return     */</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"redisTemplate"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> RedisTemplate<span class="token operator">&lt;</span>String<span class="token punctuation">,</span>Object<span class="token operator">&gt;</span> <span class="token function">redisTemplate</span><span class="token punctuation">(</span>RedisConnectionFactory factory<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 配置redisTemplate</span>        RedisTemplate<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">&gt;</span> redisTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        redisTemplate<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// key序列化</span>        redisTemplate<span class="token punctuation">.</span><span class="token function">setKeySerializer</span><span class="token punctuation">(</span>STRING_SERIALIZER<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// value序列化</span>        redisTemplate<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span>JACKSON__SERIALIZER<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// Hash key序列化</span>        redisTemplate<span class="token punctuation">.</span><span class="token function">setHashKeySerializer</span><span class="token punctuation">(</span>STRING_SERIALIZER<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// Hash value序列化</span>        redisTemplate<span class="token punctuation">.</span><span class="token function">setHashValueSerializer</span><span class="token punctuation">(</span>JACKSON__SERIALIZER<span class="token punctuation">)</span><span class="token punctuation">;</span>        redisTemplate<span class="token punctuation">.</span><span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><p>在utils目录下定义了RedisUtil工具类，该工具类主要一些Redis的常见操作：包括设置key、判断key是否存在、删除key值等操作。业务类可直接使用Redis工具类来操作Redis，降低了程序的耦合性。</p><p>在业务类中调用Redis工具类的判断key值是否存在的方法来判断当前房源ID的推荐列表是否已经存在于Redis缓存，若已经存在时则直接返回结果；若不存在时，则通过RPC服务的方式调用推荐算法，并将生成的推荐列表进行缓存，以供下次使用。</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*Redis缓存判断逻辑*/</span><span class="token keyword">if</span><span class="token punctuation">(</span>redisUtil<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">//判断该房源推荐列表是否已经在redis中缓存过</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"已经在redis中缓存过"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    roomIdList<span class="token operator">=</span>redisUtil<span class="token punctuation">.</span><span class="token function">getList</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"第一次推荐，未缓存"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    roomIdList<span class="token operator">=</span>PythonRpc<span class="token punctuation">.</span><span class="token function">generateSimilarityList</span><span class="token punctuation">(</span>city<span class="token punctuation">,</span> roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//推荐列表缓存进redis</span>    redisUtil<span class="token punctuation">.</span><span class="token function">setList</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>roomIdList<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><h2 id="效果展示"><a href="#效果展示" class="headerlink" title="效果展示"></a>效果展示</h2><p><img src="http://ww1.sinaimg.cn/mw690/006SFsamly1gs44hsxl0zj30sg0nigq3.jpg" alt="小程序Tab页"></p><p><img src="http://ww1.sinaimg.cn/mw690/006SFsamly1gs44htvs9dj30sc0nl4e2.jpg" alt="房源详情页"></p><p><img src="http://ww1.sinaimg.cn/mw690/006SFsamly1gs44ht04lsj30se0njtk0.jpg" alt="收藏与取消收藏页"></p><h2 id="备注"><a href="#备注" class="headerlink" title="备注"></a>备注</h2><ul><li><p>数据来源于安居客，数据不得商用，仅供科研学习使用！</p><p>链接: <a href="https://pan.baidu.com/s/12Ozcf6M5Rcrmqbr3w_Qv0A">https://pan.baidu.com/s/12Ozcf6M5Rcrmqbr3w_Qv0A</a> 提取码: b7mx </p></li><li><p>小程序中使用到腾讯地图SDK,需要自己申请App key。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 推荐系统 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RPC </tag>
            
            <tag> SpringBoot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP拥塞窗口笔记</title>
      <link href="/2020/06/26/tcp-yong-sai-chuang-kou-bi-ji/"/>
      <url>/2020/06/26/tcp-yong-sai-chuang-kou-bi-ji/</url>
      
        <content type="html"><![CDATA[<h1 id="TCP拥塞窗口笔记"><a href="#TCP拥塞窗口笔记" class="headerlink" title="TCP拥塞窗口笔记"></a>TCP拥塞窗口笔记</h1><p><img src="https://i.loli.net/2020/06/26/8oluqnX16MsOYZj.png" alt="拥塞窗口变化曲线"></p><p><code>拥塞窗口</code> cwnd</p><p><code>慢启动门限</code> ssthresh （slow start threshold）状态变量。</p><ul><li>当 cwnd &lt; ssthresh 时，使用慢启动算法。</li><li>当 cwnd &gt;= ssthresh 时，就会使用「拥塞避免算法」</li></ul><p>这是一张关于传输轮次与拥塞窗口的关系图</p><p>可以看出，在第6传输轮次的时候，由慢开始算法变为拥塞避免算法，因而此刻的 ssthresh 门限 = cwnd 发送窗口为 64，因而初始门限值为64。</p><p>在15次的时候，因为发生了网络拥塞，进行乘法减小，继续拥塞避免加法增大，此时cwnd不减为1，而是变为原来一半，当前 sshthresh 门限=cwnd，报文的丢失是根据收到了三个重复的确认。</p><p>在第22次传输轮次时，发生网络拥塞，由拥塞避免恢复到慢开始算法，cwnd置为1，报文的丢失是根据超时重传检测的。</p>]]></content>
      
      
      <categories>
          
          <category> 计算机网络 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 拥塞窗口 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>漫画图解HDFS原理</title>
      <link href="/2020/02/14/man-hua-tu-jie-hdfs-ji-ben-yuan-li/"/>
      <url>/2020/02/14/man-hua-tu-jie-hdfs-ji-ben-yuan-li/</url>
      
        <content type="html"><![CDATA[<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>HDFS(Hadoop Distributed File Syatem)中文名为<strong>Hadoop分布式文件系统</strong>,是属于Hadoop软件自带的分布式文件系统。</p><h2 id="系统构成与写数据过程"><a href="#系统构成与写数据过程" class="headerlink" title="系统构成与写数据过程"></a>系统构成与写数据过程</h2><p><img src="https://i.loli.net/2020/02/14/QOCDWm25eicsTjv.png"></p><p><img src="https://i.loli.net/2020/02/14/I3p74sDhqT2Nj8H.png"></p><p><img src="https://i.loli.net/2020/02/14/RDYNogHuGS8XxbQ.png"></p><h2 id="读数据过程"><a href="#读数据过程" class="headerlink" title="读数据过程"></a>读数据过程</h2><p><img src="https://i.loli.net/2020/02/14/4XvIhEWnwOkNigM.png"></p><h2 id="容错机制"><a href="#容错机制" class="headerlink" title="容错机制"></a>容错机制</h2><h3 id="故障类型与故障检测"><a href="#故障类型与故障检测" class="headerlink" title="故障类型与故障检测"></a>故障类型与故障检测</h3><p><img src="https://i.loli.net/2020/02/14/yiKtIUPvdZnFWqL.png"></p><p><img src="https://i.loli.net/2020/02/14/tHK8SLTfgqYWIey.png"></p><h3 id="读写故障处理"><a href="#读写故障处理" class="headerlink" title="读写故障处理"></a>读写故障处理</h3><p><img src="https://i.loli.net/2020/02/14/wXdpF5KfznIYC3N.png"></p><h3 id="DataNode故障处理"><a href="#DataNode故障处理" class="headerlink" title="DataNode故障处理"></a>DataNode故障处理</h3><p><img src="https://i.loli.net/2020/02/14/yJ4qYcT9ns5OLfS.png"></p><h3 id="副本布局策略"><a href="#副本布局策略" class="headerlink" title="副本布局策略"></a>副本布局策略</h3><p><img src="https://i.loli.net/2020/02/14/5MZveXQBN1oCYIG.png"></p><blockquote><p>参考文章：<a href="https://blog.csdn.net/hudiefenmu/article/details/37694503">https://blog.csdn.net/hudiefenmu/article/details/37694503</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 大数据组件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HDFS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redis初探</title>
      <link href="/2020/02/01/redis-chu-tan/"/>
      <url>/2020/02/01/redis-chu-tan/</url>
      
        <content type="html"><![CDATA[<h2 id="redis介绍"><a href="#redis介绍" class="headerlink" title="redis介绍"></a>redis介绍</h2><p>redis 是一个基于 C 语言编写，遵守开源 BSD 协议，支持持久化，完全开源免费的高性 能（key-value）内存型数据库。相比memcache而言，redis支持的数据类型更加广泛，而memcache只支持string类型的字符串。</p><h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><p>在没有redis缓存的业务中，所有的数据读写请求都是通过数据库来完成，数据库每次读写都需要进行磁盘IO，在请求频率低的时候数据库尚能应付，若同时有大量的读写请求直接打在数据库上，将会对数据库造成巨大的压力。并且在真实的业务场景中多数都是读请求，数据的结果不经常发生变化，所以可以将这种数据放在内存上，每次从内存里边去拿数据，这样会比让数据库去进行磁盘IO快很多。因此，我们可以把访问频率高，且不经常更新的数据放在redis中，若需要对数据进行写操作，也可在redis中进行操作，然后再将操作结果同步到数据库中。</p><p>redis有以下的常见应用场景：</p><ul><li><p>缓存</p><p>对于一些用户经常访问的数据，可以将其直接缓存在redis中，避免了每次请求数据库的操作，减轻了数据库的负担。</p></li><li><p>排行榜</p><p>redis中的SortedSet(有序集合)可以很方便的实现排行榜的功能，而使用关系型数据库来实现则会较为复杂。</p></li><li><p>简单消息队列</p><p>在一些要求不高的场景中，可以使用redis中的订阅/发布功能来实现一个简单的消息队列，或者也可使用List数据结构来实现一个队列发送异步消息，比如到货通知、邮件通知等操作。</p></li><li><p>好友关系</p><p>利用集合的一些命令，比如求交集、并集、差集等。可以方便搞定一些共同好友、共同爱好之类的功能。</p></li><li><p>计算器与限速器</p><p>计算器主要是应用在一些统计点赞数、浏览数的操作中，如果使用关系型数据库来实现，那么每次读写数据库会造成非常大的磁盘IO负担，因此可以使用redis中原子性自增操作来实现；而限速器则是可以控制比如限定一个API的访问频率，以至于不会让系统造成过大压力。</p></li></ul><h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><ul><li><p>String类型</p><p>String是redis中最基本的数据类型，string 类型是二进制安全的，意思是 redis 的 string 可以包含任何数据，比如jpg图片或者序列化的对象。</p></li><li><p>ZSet</p></li><li><p>Hash</p></li><li><p>List</p><p>List是简单的字符串列表，可以对列表进行插入和删除元素的操作。</p><table><thead><tr><th align="center">命令</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center">RPUSH</td><td align="center">RPUSH key-name value1,value2…将一个或多个值压入列表右端</td></tr><tr><td align="center">LPUSH</td><td align="center">LPUSH key-name value1,value2…将一个或多个值压入列表左端</td></tr><tr><td align="center">RPOP</td><td align="center">RPOP key-name   移除并返回最右端的元素</td></tr><tr><td align="center">LPOP</td><td align="center">LPOP key-name   移除并返回最左端的元素</td></tr><tr><td align="center">LINDEX</td><td align="center">LINDEX key-name offset返回列表中偏移量为offset的元素</td></tr><tr><td align="center">LRANGE</td><td align="center">LRANGE key-name start end 返回列表中偏移量为start到end的所有元素（也包括start与end）</td></tr><tr><td align="center">LTRIM</td><td align="center">LTRIM key-name start end 对列表修剪，保留start到end内的所有元素（也包括start与end）</td></tr></tbody></table></li></ul><h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><h2 id="持久化机制"><a href="#持久化机制" class="headerlink" title="持久化机制"></a>持久化机制</h2><h4 id="AOF"><a href="#AOF" class="headerlink" title="AOF"></a>AOF</h4><h3 id="RDB"><a href="#RDB" class="headerlink" title="RDB"></a>RDB</h3><h2 id="常见异常"><a href="#常见异常" class="headerlink" title="常见异常"></a>常见异常</h2><h3 id="缓存穿透"><a href="#缓存穿透" class="headerlink" title="缓存穿透"></a>缓存穿透</h3><h3 id="缓存雪崩"><a href="#缓存雪崩" class="headerlink" title="缓存雪崩"></a>缓存雪崩</h3><h3 id="缓存击穿"><a href="#缓存击穿" class="headerlink" title="缓存击穿"></a>缓存击穿</h3>]]></content>
      
      
      <categories>
          
          <category> 中间件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常见排序算法总结</title>
      <link href="/2020/01/30/chang-jian-pai-xu-suan-fa-zong-jie/"/>
      <url>/2020/01/30/chang-jian-pai-xu-suan-fa-zong-jie/</url>
      
        <content type="html"><![CDATA[<h2 id="算法分类"><a href="#算法分类" class="headerlink" title="算法分类"></a>算法分类</h2><p>一般的，算法可分为两类：<strong>非线性时间比较类排序、线性时间非比较类排序</strong></p><p><strong>非线性时间比较类排序</strong>：通过比较来决定元素间的相对次序，由于其时间复杂度不能突破O(nlogn)，因此称为非线性时间比较类排序。</p><p><strong>线性时间非比较类排序</strong>：不通过比较来决定元素间的相对次序，它可以突破基于比较排序的时间下界，以线性时间运行，因此称为线性时间非比较类排序。</p><p>这里可能不太容易理解，下边直接放一张图便于理解。</p><p><img src="https://i.loli.net/2020/02/11/sUGBuF9twD16gJ4.png" alt="排序算法分类"></p><h2 id="算法实现"><a href="#算法实现" class="headerlink" title="算法实现"></a>算法实现</h2><h3 id="交换类排序"><a href="#交换类排序" class="headerlink" title="交换类排序"></a>交换类排序</h3><h4 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h4><p>排序思想：每趟排序比较两个相邻的元素，若比较的两个元素为逆序，则将两者交换，否则不动，每趟比较都可确定一个元素的最终位置，n个元素总共需要n-1趟排序。</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*冒泡排序时间复杂度：o(n2) */</span><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">bubbleSort</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">boolean</span> flag<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//标记是否发生元素交换</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>data<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//控制排序趟数（n个数排序n-1次就行，最后一次不用排，剩下的数就是最大或最小的数）</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>data<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span>i<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//控制每趟比较的次数，每趟比较的次数逐渐减少</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&gt;</span>data<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>                <span class="token keyword">int</span> temp<span class="token operator">=</span>data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>                data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>data<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                data<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>temp<span class="token punctuation">;</span>                flag<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>flag<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//本趟冒泡没有发生元素交换，则说明元素已经有序，无需再进行后续的比较</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        flag<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><h4 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h4><p>排序思想：每次从表中选择一个基准元素（pivot），一般取表中第一个位置，设置一个low指针，一个high指针，high指针从表尾往前扫，查找比基准元素小的值，找到了则放到low指针所指向的位置，high指针暂停；low指针从表头往后扫，寻找比基准元素大的元素，找到后交换到high指针所指向的位置，然后轮到high指针走，最终直到low指针与high指针相遇则排序结束。</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*快速排序:递归分治思想（中间点为参考点，左边的值比中间值小，右边的值比中间值大，依此类推） */</span><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">quickSort</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">,</span><span class="token keyword">int</span> low<span class="token punctuation">,</span><span class="token keyword">int</span> high<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>low<span class="token operator">&gt;</span>high<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> l<span class="token operator">=</span>low<span class="token punctuation">;</span>    <span class="token keyword">int</span> h<span class="token operator">=</span>high<span class="token punctuation">;</span>    <span class="token keyword">int</span> basic<span class="token operator">=</span>data<span class="token punctuation">[</span>low<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//基准参考点默认首元素</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>l<span class="token operator">!=</span>h<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>l<span class="token operator">&lt;</span>h <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token operator">&gt;=</span>basic<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">//从后向前比较</span>            h<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>l<span class="token operator">&lt;</span>h <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token operator">&lt;=</span>basic<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">//从前向后比较</span>            l<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token operator">&lt;</span>h<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//交换二者位置</span>            <span class="token keyword">int</span> temp<span class="token operator">=</span>data<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">;</span>            data<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token operator">=</span>data<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>            data<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token operator">=</span>temp<span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//最终交换结束后参考值归位</span>    data<span class="token punctuation">[</span>low<span class="token punctuation">]</span><span class="token operator">=</span>data<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>    data<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token operator">=</span>basic<span class="token punctuation">;</span>    <span class="token function">quickSort</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>low<span class="token punctuation">,</span>l<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//继续处理左边的，这里是一个递归的过程</span>    <span class="token function">quickSort</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>high<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//继续处理右边的 ，这里是一个递归的过程</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><h3 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h3><h4 id="直接插入排序"><a href="#直接插入排序" class="headerlink" title="直接插入排序"></a>直接插入排序</h4><p>排序思想：将当前的排序表分为两部分，已排好序的表与待排序的表，每次将待排序表中第一个位置的元素从后向前依次与已排好序表中元素比较，知道大于当前位置元素则选择插入，将该位置及其后的元素全部同一后移，依次把n个元素插入，共需要n-1趟排序。</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*插入排序:若key值前的元素比key值大，则将元素依次后移，知道比key值小时将key值插入该位置 */</span><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insertionSort</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>data<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> key<span class="token operator">=</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//key为待插入的值</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&gt;=</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&gt;</span>key<span class="token punctuation">;</span>j<span class="token operator">--</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            data<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        data<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>key<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>空间复杂度：<span class="token function">o</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>时间复杂度：</code></pre><h4 id="折半插入排序"><a href="#折半插入排序" class="headerlink" title="折半插入排序"></a>折半插入排序</h4><p>排序思想：同属于插入类排序，与直接插入排序的不同之处在于其寻找插入位置的时候不再“挨个”比较，而是直接每次通过折半查找的方式查找插入位置，这就可使得查找长度降到log2n量级。</p><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">BinaryInsertSort</span><span class="token punctuation">(</span><span class="token keyword">int</span> A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>low<span class="token punctuation">,</span>high<span class="token punctuation">,</span>mid<span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        A<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        low<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>high<span class="token operator">=</span>i<span class="token number">-1</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>low<span class="token operator">&lt;=</span>high<span class="token punctuation">)</span>        <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            mid<span class="token operator">=</span><span class="token punctuation">(</span>low<span class="token operator">+</span>high<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>A<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token operator">&gt;</span>A<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                high<span class="token operator">=</span>mid<span class="token number">-1</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                low<span class="token operator">=</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span>i<span class="token number">-1</span><span class="token punctuation">;</span>j<span class="token operator">&gt;=</span>high<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token operator">--</span>j<span class="token punctuation">)</span>            A<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>A<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>        A<span class="token punctuation">[</span>high<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>A<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><h4 id="希尔排序"><a href="#希尔排序" class="headerlink" title="希尔排序"></a>希尔排序</h4><p>排序思想：又称为<strong>缩小增量排序</strong>，主要思想是每趟排序根据一个<strong>增量d</strong>把排序表划分为几个子表，每相邻步长为d的元素组成一个子表，在每个子表内部进行插入排序，知道最后的增量缩减到1，也就是最后一趟排序可以看为是对整张表进行插入排序。</p><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">shellSort</span><span class="token punctuation">(</span>ElemType A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> dk<span class="token punctuation">,</span>i<span class="token punctuation">,</span>j<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>dk <span class="token operator">=</span> n<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span> dk<span class="token operator">&gt;=</span><span class="token number">1</span><span class="token punctuation">;</span> dk<span class="token operator">=</span>dk<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span>dk<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;</span>A<span class="token punctuation">[</span>i<span class="token operator">-</span>dk<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>                A<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span>i<span class="token operator">-</span>dk<span class="token punctuation">;</span>j<span class="token operator">&gt;</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>A<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;</span>A<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>j<span class="token operator">-</span><span class="token operator">=</span>dk<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>                    A<span class="token punctuation">[</span>j<span class="token operator">+</span>dk<span class="token punctuation">]</span><span class="token operator">=</span>A<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>                A<span class="token punctuation">[</span>j<span class="token operator">+</span>dk<span class="token punctuation">]</span><span class="token operator">=</span>A<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span> <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><h3 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h3><h4 id="简单选择排序"><a href="#简单选择排序" class="headerlink" title="简单选择排序"></a>简单选择排序</h4><p>排序思想：将排序表看作两部分，待排序部分与已排好序部分，每次从剩余的待排序元素中找出一个最小的元素，放在待排序表中第一个位置，直到把表中所有元素放在相应位置，n个元素需要进行n-1次选择排序。</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*选择排序 */</span><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">selectionSort</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> min<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>temp<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>data<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        min<span class="token operator">=</span>i<span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">//标记最小值的索引</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>data<span class="token punctuation">.</span>length<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&lt;</span>data<span class="token punctuation">[</span>min<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>                min<span class="token operator">=</span>j<span class="token punctuation">;</span>            <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        temp<span class="token operator">=</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>data<span class="token punctuation">[</span>min<span class="token punctuation">]</span><span class="token punctuation">;</span>        data<span class="token punctuation">[</span>min<span class="token punctuation">]</span><span class="token operator">=</span>temp<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><h4 id="堆排序"><a href="#堆排序" class="headerlink" title="堆排序"></a>堆排序</h4><p>大根堆：根节点的值都是大于左右孩子的值<br>小根堆：根节点的值都是小于左右孩子的值<br>i号位置的左孩子位置为2i,右孩子位置为2i+1<br>排序思想：首先建立一棵堆（本质上是满足上述关系的二叉树），然后每次将根节点与堆底结点交换，同时对于剩余部分的堆进行调整操作（交换的堆顶元素排除在外），直到把堆中所有堆顶元素依次放入堆底，此时的存储堆线性表即为一个有序表。</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/** * @description:建堆函数  * @param &amp;#123;int&amp;#125; A * @param &amp;#123;int&amp;#125; length * @return &amp;#123;*&amp;#125; */</span><span class="token keyword">void</span> <span class="token function">buildMaxHeap</span><span class="token punctuation">(</span><span class="token keyword">int</span> A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> length<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>length<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">--</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token function">headAdjust</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span>i<span class="token punctuation">,</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * @description: 调整以某个结点为根节点的堆 * @param &amp;#123;int&amp;#125; A * @param &amp;#123;int&amp;#125; root * @param &amp;#123;int&amp;#125; length * @return &amp;#123;*&amp;#125; */</span><span class="token keyword">void</span> <span class="token function">headAdjust</span><span class="token punctuation">(</span><span class="token keyword">int</span> A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> root<span class="token punctuation">,</span><span class="token keyword">int</span> length<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    A<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>A<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">;</span>               <span class="token comment" spellcheck="true">//A[0]暂存当前根节点的值</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>root<span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>length<span class="token punctuation">;</span>i<span class="token operator">*</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span>length<span class="token operator">&amp;&amp;</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;</span>A<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>       <span class="token comment" spellcheck="true">//筛选出较大的孩子</span>            i<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>A<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;=</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">else</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            A<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token operator">=</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>               <span class="token comment" spellcheck="true">//将A[i]调整到双亲结点</span>            root<span class="token operator">=</span>i<span class="token punctuation">;</span>                     <span class="token comment" spellcheck="true">//修改根节点值，在新的子树中进行筛选</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    A<span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token operator">=</span>A<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                          <span class="token comment" spellcheck="true">//被筛选的结点放在最终位置</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * @description:堆排序  * @param &amp;#123;int&amp;#125; A * @param &amp;#123;int&amp;#125; length * @return &amp;#123;*&amp;#125; */</span><span class="token keyword">void</span> <span class="token function">heapSort</span><span class="token punctuation">(</span><span class="token keyword">int</span> A<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> length<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token function">buildMaxHeap</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment" spellcheck="true">//初始建堆</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">--</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>               <span class="token function">swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>A<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">//输出堆顶元素</span>        <span class="token function">headAdjust</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>i<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">//调整，把剩余的i-1个元素整理成堆      </span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><h3 id="归并排序-二路"><a href="#归并排序-二路" class="headerlink" title="归并排序(二路)"></a>归并排序(二路)</h3><p>排序思想：初始状态下，把每个元素都看作是一个有序的表，然后两两进行合并，核心过程就是把两个有序表合并为一个有序表，递归的去合并，相当于从树的叶子节点处开始构造一棵二叉树，而快速排序则是从树的根节点处开始递归划分构造二叉树，两者核心思想刚好是相反的。</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/** * @description: 合并两个线性表 * @param &amp;#123;int&amp;#125; arr * @param &amp;#123;int&amp;#125; temp * @param &amp;#123;int&amp;#125; leftPos * @param &amp;#123;int&amp;#125; rightPos * @param &amp;#123;int&amp;#125; rightEnd * @return &amp;#123;*&amp;#125; */</span> <span class="token keyword">void</span> <span class="token function">merge</span><span class="token punctuation">(</span><span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> temp<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> leftPos<span class="token punctuation">,</span><span class="token keyword">int</span> rightPos<span class="token punctuation">,</span><span class="token keyword">int</span> rightEnd<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>     <span class="token keyword">int</span> leftEnd <span class="token operator">=</span> rightPos <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 左边结束下标</span>        <span class="token keyword">int</span> tempPos <span class="token operator">=</span> leftPos<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 从左边开始算</span>        <span class="token keyword">int</span> numEle <span class="token operator">=</span> rightEnd <span class="token operator">-</span> leftPos <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 元素个数</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>leftPos <span class="token operator">&lt;=</span> leftEnd <span class="token operator">&amp;&amp;</span> rightPos <span class="token operator">&lt;=</span> rightEnd<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>leftPos<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> arr<span class="token punctuation">[</span>rightPos<span class="token punctuation">]</span><span class="token punctuation">)</span>                temp<span class="token punctuation">[</span>tempPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>leftPos<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                temp<span class="token punctuation">[</span>tempPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>rightPos<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>leftPos <span class="token operator">&lt;=</span> leftEnd<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 左边如果有剩余</span>            temp<span class="token punctuation">[</span>tempPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>leftPos<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>rightPos <span class="token operator">&lt;=</span> rightEnd<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 右边如果有剩余</span>            temp<span class="token punctuation">[</span>tempPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>rightPos<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 将temp复制到arr</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numEle<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            arr<span class="token punctuation">[</span>rightEnd<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">[</span>rightEnd<span class="token punctuation">]</span><span class="token punctuation">;</span>            rightEnd<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * @description: 归并排序 * @param &amp;#123;int&amp;#125; arr * @param &amp;#123;int&amp;#125; temp * @param &amp;#123;int&amp;#125; left * @param &amp;#123;int&amp;#125; right * @return &amp;#123;*&amp;#125; */</span><span class="token keyword">void</span> <span class="token function">mergeSort</span><span class="token punctuation">(</span><span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> temp<span class="token punctuation">,</span><span class="token keyword">int</span> left<span class="token punctuation">,</span><span class="token keyword">int</span> right<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> center <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token function">mergeSort</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> temp<span class="token punctuation">,</span> left<span class="token punctuation">,</span> center<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 左边</span>            <span class="token function">mergeSort</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> temp<span class="token punctuation">,</span> center <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> right<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 右边</span>            <span class="token function">merge</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> temp<span class="token punctuation">,</span> left<span class="token punctuation">,</span> center <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> right<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 合并两个有序</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 数据结构与算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 快速排序 </tag>
            
            <tag> 插入排序 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019年总结</title>
      <link href="/2020/01/19/2019-nian-zong-jie/"/>
      <url>/2020/01/19/2019-nian-zong-jie/</url>
      
        <content type="html"><![CDATA[<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>2019年过去了，虽然现在已经是2020年一月下旬了，但是我不太喜欢去用阳历的时间划分时间节点，即使自己生日都是过的阴历生日，可能自己性格属于那种比较偏老成一些吧。去年大年三十晚上是我第一次写自己的年终总结，我可能真是个神人，大年三十晚上写完总结才去吃的年夜饭，可能自己有一些强迫症吧。回顾自己这一年的点点滴滴，感觉比之前更加务实了很多，之前大一大二那会做过很多傻事，所以感觉2019年变得稍微稳重了一些，如果给自己2019年的工作打个分的话就是80分吧（满分100），我的2019年简而言之可以用以下的关键词总结：<strong>三次比赛</strong>、<strong>一场马拉松</strong>、<strong>一次实习</strong>、<strong>两次旅行</strong>、<strong>一场演唱会</strong>。</p><h2 id="比赛"><a href="#比赛" class="headerlink" title="比赛"></a>比赛</h2><h3 id="微信小程序开发大赛"><a href="#微信小程序开发大赛" class="headerlink" title="微信小程序开发大赛"></a>微信小程序开发大赛</h3><p>之前一直没有参加过什么比赛，所以我在今年就想着能多去参加一些比赛锻炼一下自己的能力，因为之前给别人做过微信小程序的缘故所以就想着参加一下，或许会比较有把握，然而最后的结果并不那么好，看来还得更加努力了。</p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq1lqm4qs4j31400u0npd.jpg" alt="当时在西北大学听腾讯产品经理开的的宣讲会"></p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq2374vcx9j31400u04qq.jpg" alt="和学弟在创咖敲代码"></p><p>其实当时四月份的时候就开始留意比赛的信息了，但是一直到五月份才正式开始做，我觉得最后没能得奖我自己有很多失误的地方</p><ol><li><p>开始做的太晚导致时间不够</p></li><li><p>团队成员都是新手，再加上能力都一般，所以效率很低</p></li><li><p>小程序的主题不是那么明确，实用性不高</p></li></ol><p>不过不管怎么样都算是积累了一次宝贵的经验吧，寒假这几天在家把之前的项目整理了一下放在了github上边，后边想看的时候也可以再看看。</p><h3 id="全国大学生数学建模竞赛"><a href="#全国大学生数学建模竞赛" class="headerlink" title="全国大学生数学建模竞赛"></a>全国大学生数学建模竞赛</h3><p>数学建模之前大一那会参加过一次校赛，但是无奈找的队友实在坑人就不提了。这次参加的是九月份的国赛，按照我们学校的惯例是参加国赛的都需要进行暑期培训，不过因为我之前并没有打算参加数学建模竞赛，是之前的一个同学他们一个队友因为中秋节要回家才临时找的我，所以我就完美的躲过了培训~hahaha(本来我暑假那会也在实习，没有时间)。</p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq2370mm4ej31400u0hdt.jpg" alt="沉思中"></p><p>我当时负责的是编程实现模型，事实上并不仅仅是编程，因为当时做的题目需要大量航班数据，所以我又自己写了一个爬虫程序爬了几千个航班数据，说实话，那几天的工作强度真心顶不住<span class="github-emoji"><span>😢</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f622.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>，不过最后很欣慰的是拿了陕西省二等奖<span class="github-emoji"><span>😄</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>。</p><h3 id="共享杯比赛"><a href="#共享杯比赛" class="headerlink" title="共享杯比赛"></a>共享杯比赛</h3><p>当时忙完数学建模竞赛后便基本没啥事了，所以想着再参加一些比赛，下学期考研应该也就没时间参加比赛了，刚好无意中在网上看到<a href="http://share.escience.net.cn/nav/newIndex"><strong>“共享杯”大学生科技资源共享服务创新大赛</strong></a>就想着参加参加看，当时做的是一个双人在线灾害知识竞赛的桌面软件，类似于单词PK那种形式，比较创新的地方可能就是使用了Electron和websocket技术，页面没有用传统的类似于QT那种图形库做，而是找了一个做前端的同学直接用前端网页的形式做的，最后直接部署在Electron这个桌面框架里边，另外websocket也是我第一次用，平时的客户机与服务器的网络通信大都是一次性的，发送完成后下次发送需要重新连接，但是websocket则是类似于打电话一样实时交互，下边放几张应用运行的截图吧。</p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq239p3667j30jm09gwj0.jpg" alt="应用主页"></p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq2367hsu8j30js0b3404.jpg" alt="答题页面"></p><h2 id="大学城马拉松"><a href="#大学城马拉松" class="headerlink" title="大学城马拉松"></a>大学城马拉松</h2><p>有史以来第一次参加马拉松，虽然是青春跑（只有6.5公里），但是跑完真的太累了，还好当时没放弃，总之非常nice，以后有机会还会再参加的。</p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq236g6k6qj31400u0npe.jpg" alt="鸣枪开跑"></p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq2368ar6dj31400u0qv5.jpg" alt="奖牌(我记得自己当时好像跑了七十多名😁)"></p><h2 id="暑假实习"><a href="#暑假实习" class="headerlink" title="暑假实习"></a>暑假实习</h2><p>因为本科在的实验室一直和西安中霖科技公司这边有合作项目，再加上我们一般暑假假期只有四十天左右，也没时间去面试别的公司，因为大都要求实习三个月起步，所以当时给老师说了一下就直接去公司实习了，公司不是很大，大概只有五十个人左右，一直做的是政府的项目，所以搬到陕西省科技厅里边办公，不过我当时住学校，每天早上坐公交去上班就得一个多小时，所以经常都是踩点到。当时做的模块是类似于pdf预览的功能，不过pdf里边的内容每次都不一样，都是动态生成的数据，当时确实感觉自己挺菜的，还好感谢各位同事们的关照，真的收获很多。</p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq236c6ceij31400u0qv5.jpg" alt="就在科技厅的楼里边上班"></p><h2 id="旅行"><a href="#旅行" class="headerlink" title="旅行"></a>旅行</h2><h3 id="关山草原研讨会"><a href="#关山草原研讨会" class="headerlink" title="关山草原研讨会"></a>关山草原研讨会</h3><p>当时六月份的时候实验室和有合作项目的公司去关山草原开会，我和另外一个大三的学长去的，每个人都需要做一个自己的近期工作汇报（不过我感觉我似乎主要是过去玩的<span class="github-emoji"><span>😆</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f606.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>），我当时就把自己近期做的工作大概讲了一下，然后和公司的技术leader交流了一下使用的技术栈。</p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq2369vu62j31940u0hdt.jpg" alt="其实感觉自己有点在瞎讲"></p><p>不过说实话，收获最多的可能是这里的美景了。</p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq236k6d2kj31hc0u04qs.jpg" alt="角度问题感觉我被绳子牵着"></p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq236k3w55j31hc0u0kjo.jpg" alt="有种在欧洲农场的感觉"></p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq236j2pjzj31hc0u0u0z.jpg" alt="只有🐂，没有🐏"></p><h3 id="重庆之行"><a href="#重庆之行" class="headerlink" title="重庆之行"></a>重庆之行</h3><p>八月份的时候我姐调休刚好有一周的假期所以就带上我去重庆玩了一圈，之前一直在陕西这个地方打转，这算是我第一次出省了，也是第一次坐高铁（毕竟我上大学回家直接坐公交车就到家了，所以真的不怎么出远门）。从西安到重庆五个小时，但是在动车上丝毫没有觉得时间过得慢，一路上的景色真的很好，放张在动车上拍的外边的景色吧</p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq236gnag8j31400u07wi.jpg" alt="这会应该是在四川广元"></p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq236eiqrpj31400u01ky.jpg" alt="洪崖洞夜景"></p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq236c1z58j31400u04qq.jpg" alt="千厮门大桥"></p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq236fc93rj31hc0u0u0y.jpg" alt="鹅岭公园视角，一览众山小的感觉"></p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq236aurq4j31400u0hdu.jpg" alt="李子坝轻轨穿楼"></p><h2 id="鹿先森演唱会"><a href="#鹿先森演唱会" class="headerlink" title="鹿先森演唱会"></a>鹿先森演唱会</h2><p>十月份那会无意中在网易云音乐看到鹿先森乐队的全国巡演，十二月底在西安会有演唱会，刚好那会手里的实习工资还没花完，所以就二话不说买了票，静等演唱会的那天，演唱会那天和舍友gay峰（之所以叫gay峰可能是他每次在宿舍很gay吧😂）一块去的，感觉体验很好，就是人多里边有点热，非常nice,期待下次再遇鹿先森~</p><p><img src="http://ww1.sinaimg.cn/large/006SFsamgy1gq236dqosij31400u01ky.jpg" alt="鹿先森演唱会"></p><h2 id="新的起点、新的征途"><a href="#新的起点、新的征途" class="headerlink" title="新的起点、新的征途"></a>新的起点、新的征途</h2><p>2020年对我来说将是不平常的一年，今年我二十岁了(也是全面建成小康社会的攻坚之年hhhh，回归正题)，之前一直在考研与工作之间犹豫不定，认真的分析了一下当前情况觉得还是应该再读研深造一下，家里人也非常支持我考研，同时也觉得趁着年轻多给自己镀点金有利无弊。总之可以预想到的是在接下来一年会面对很多困难，遇到很多挫折，希望自己能够更加沉得住气，养成更好的学习习惯，更加充分的利用时间，最后用自己很喜欢的一句话诫勉自己吧——修得平常心，才成非凡事。</p><p>2021考研加油，愿每个小梦想都可以实现！</p>]]></content>
      
      
      <categories>
          
          <category> 随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 总结 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>百度文库文档下载</title>
      <link href="/2019/12/19/bai-du-wen-ku-wen-dang-xia-zai/"/>
      <url>/2019/12/19/bai-du-wen-ku-wen-dang-xia-zai/</url>
      
        <content type="html"><![CDATA[<p>之前用过一个百度文库在线下载文档的网站，非常好用，除了付费购买的不能下载之外其他的都可以下载，所以在这里安利一下。</p><p>网址：<a href="http://www.blpack.com/">http://www.blpack.com/</a></p>]]></content>
      
      
      <categories>
          
          <category> 资源分享 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 百度文库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浏览器请求一个URL详细过程</title>
      <link href="/2019/12/12/liu-lan-qi-qing-qiu-yi-ge-url-xiang-xi-guo-cheng/"/>
      <url>/2019/12/12/liu-lan-qi-qing-qiu-yi-ge-url-xiang-xi-guo-cheng/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>基本每个人每天都会使用到浏览器进行上网，那么在我们输入一个网址后其背后运行的原理是什么样的？如何将一个玲琅满目的网页显示出来，其中经历了一个怎样的过程，总的来说，分为以下几个过程</p><ul><li>DNS解析</li><li>HTTP请求发送</li><li>服务器处理请求并返回结果</li><li>浏览器渲染页面</li><li>连接结束</li></ul><h1 id="具体过程"><a href="#具体过程" class="headerlink" title="具体过程"></a>具体过程</h1><h2 id="DNS解析"><a href="#DNS解析" class="headerlink" title="DNS解析"></a>DNS解析</h2><p>DNS解析就是寻找要访问的资源的IP地址，在计算机网络中是根据IP地址对每台主机进行定位的，相当于唯一的<strong>标识</strong>。比如小明是一名大学生，有一天他想要上淘宝买一个耳机，在浏览器地址栏输入后进行访问时会先在<a href="www.taobao.com"></a><strong>hosts</strong>文件中查看，没有的话再在<strong>本地DNS服务器</strong>(一般为所在地运营商机房)查询，本地DNS收到查询请求后会在缓存中查询，如果还没有的话本地DNS将向根域名服务器发送请求，根域名服务器收到请求后一看后缀是**.com<strong>，好了，把.com顶级域名服务器的地址返回，你去问它吧。然后.com顶级域名服务器中将</strong>taobao.com权威域名服务器**返回，权威域名服务器最终返回taobao.com对应的IP地址，下图比较详细的说明了DNS解析的过程（该图源自网络）。</p><p><img src="https://i.loli.net/2019/12/19/u6wMaQhndYpxg91.png" alt="DNS解析过程"></p><p>可使用<strong>tracert</strong>命令跟踪到URL中间的网络节点</p><pre><code>tracert www.baidu.com</code></pre><p><strong>备注：</strong>事实上可能我们大部分情况下在电脑设置里看到的本地DNS服务器地址都是192.168.XX.XX,这个大多是局域网下的路由器，而路由器也只是起到了转发的作用，将DNS请求转发到运营商机房。</p><h2 id="发送HTTP请求"><a href="#发送HTTP请求" class="headerlink" title="发送HTTP请求"></a>发送HTTP请求</h2><p>在做完DNS解析后浏览器也就得到了要请求的主机IP，接下来就是向该主机发送请求信息。虽然我们不用去关心具体请求是怎么发送过去的，但是在这里还是大概说一下。</p><p>在连接发送过程中，大概使用了以下网络协议</p><ul><li>TCP    与服务器建立TCP连接</li><li>IP            网络层协议，用于发送IP数据包</li><li>OPSF      路由协议，IP数据包在路由器间传递基于相应路由协议</li><li>ARP协议    用于将IP地址转换为MAC地址（物理地址唯一）</li><li>HTTP协议    应用层协议，用于发送HTTP报文请求</li></ul><p>以上过程作为不同计算机之间通信的必须协议，看来计算机底层帮我们做了太多的工作了^.^</p><p>另外，由于考虑到安全性请求，事实上我们大部分情况下访问网站都是发送的<strong>HTTPS</strong>请求</p><p><img src="https://onedrive.gimhoy.com/1drv/aHR0cHM6Ly8xZHJ2Lm1zL3UvcyFBcGtNdG56TnhsVm9lZWFlWUhfUXZsbHdRbkE=.png" alt="HTTPS原理"></p><p>上图中HTTPS实现加密的过程不必详细了解，只需要知道HTTPS是运行在SSL/TLS之上的HTTP协议，SSL/TLS 运行在TCP之上。所有传输的内容都经过加密，如果想要深入研究可以参考本文——<a href="https://juejin.im/post/5d53aa04f265da03934bd70c">图解HTTPS基本原理</a></p><h2 id="服务器处理请求"><a href="#服务器处理请求" class="headerlink" title="服务器处理请求"></a>服务器处理请求</h2><p>服务器主机上的服务器软件（tomcat、nginx、werkzurk等）在收到请求后，会处理请求并返回HTTP响应报文</p><p>HTTP响应报文由三部分组成：状态行、响应头部、响应正文</p><h3 id="状态行"><a href="#状态行" class="headerlink" title="状态行"></a>状态行</h3><p>由三部分组成——协议版本，状态码，状态码描述，之间由空格分隔，在这里列举了不同数字开头的状态码</p><ul><li><p>1xx：指示信息–表示请求已接收，继续处理。</p></li><li><p>2xx：成功–表示请求已被成功接收、理解、接受。</p></li><li><p>3xx：重定向–要完成请求必须进行更进一步的操作。</p></li><li><p>4xx：客户端错误–请求有语法错误或请求无法实现。</p></li><li><p>5xx：服务器端错误–服务器未能实现合法的请求。</p><p>我们所常见的404错误就是由于客户端发生错误</p></li></ul><h3 id="响应头部"><a href="#响应头部" class="headerlink" title="响应头部"></a>响应头部</h3><p>下面是一些常见的响应头部</p><table><thead><tr><th align="left">响应头</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">Server</td><td align="left">服务器应用程序软件的名称和版本</td></tr><tr><td align="left">Content-Type</td><td align="left">响应正文的类型（是图片还是二进制字符串）</td></tr><tr><td align="left">Content-Charset</td><td align="left">响应正文使用的编码</td></tr><tr><td align="left">Content-Encoding</td><td align="left">响应正文使用的数据压缩格式</td></tr><tr><td align="left">Content-Language</td><td align="left">响应正文使用的语言</td></tr></tbody></table><p>响应示例</p><p><img src="https://i.loli.net/2019/12/19/vukOdIlys8pbmre.png" alt="响应头"></p><h2 id="浏览器渲染页面"><a href="#浏览器渲染页面" class="headerlink" title="浏览器渲染页面"></a>浏览器渲染页面</h2><p>在服务器处理好请求请求并返回后，浏览器会将返回的网页源码渲染出来，浏览器渲染页面基于webkit内核，先上一张图</p><p><img src="https://i.loli.net/2019/12/19/fJPeqGlQwYFvWtR.png" alt="页面渲染过程图"></p><p>从这张图，我们可以看到浏览器会解析三个东西：</p><ul><li><p>一个是HTML/SVG/XHTML，事实上，Webkit有三个C++的类对应这三类文档。解析这三种文件会产生一个DOM Tree</p></li><li><p>CSS，解析CSS会产生CSS规则树</p></li><li><p>Javascript，脚本，主要是通过DOM API和CSSOM API来操作DOM Tree和CSS Rule Tree</p></li></ul><p>在解析完成后浏览器引擎会通过DOM Tree 和 CSS Rule Tree 来构造 Rendering Tree，最后通过调用操作系统Native GUI的API绘制。具体可以参考<a href="https://coolshell.cn/articles/9666.html">浏览器的渲染原理简介</a></p><h2 id="连接结束"><a href="#连接结束" class="headerlink" title="连接结束"></a>连接结束</h2><p>在渲染完成后一次访问请求也就结束了。事实上，第一次加载网页往往比较慢，但后续加载该网页会快很多，这是因为DNS缓存和浏览器缓存等起的作用，将一些静态资源暂时缓存到本地以备下次访问使用，可以提高了页面的加载速率，用户的体验感更好。</p><h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><ul><li><a href="https://segmentfault.com/a/1190000006879700">https://segmentfault.com/a/1190000006879700</a></li><li><a href="https://coolshell.cn/articles/9666.html">https://coolshell.cn/articles/9666.html</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 计算机网络 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DNS </tag>
            
            <tag> HTTP </tag>
            
            <tag> 页面渲染 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>细说IP</title>
      <link href="/2019/11/05/xi-shuo-ip/"/>
      <url>/2019/11/05/xi-shuo-ip/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在互联网中，每台计算机要实现通信的前提就是互相知道对方的地址，那么这个地址就是<strong>IP</strong>，通过IP地址我们可以很方便的在因特网上进行寻址。IP地址现在由因特网和数字分配机构ICANN(Internet Corporation for Assigned Names and Numbers)进行分配。</p><h1 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h1><p>按照长度分为</p><ul><li><strong>IPV4</strong>地址（4字节）</li><li><strong>IPV6</strong>地址（16字节）</li></ul><p> 按照用途分为</p><ul><li><p>公有地址（公网ip）</p></li><li><p>私有地址（内网ip）</p></li></ul><p>另外，IP地址的编址方法一共经过了三个阶段。</p><ol><li><p>分类的IP地址，最基本的编址方法，下文将详细叙述。</p></li><li><p>子网的划分，对最基本编址方法的改进，其标准RFC 950在1985年通过。</p></li><li><p>构成超网，属于比较新的无分类编址方法，1993年提出后很快得到推广应用</p></li></ol><blockquote><p>在分类IP地址中，IP地址由两段构成，网络号与主机号<br>          IP地址  =网络号+主机号</p></blockquote><h2 id="IPV4"><a href="#IPV4" class="headerlink" title="IPV4"></a>IPV4</h2><blockquote><p><strong>网际协议版本4</strong>（英语：<strong>I</strong>nternet <strong>P</strong>rotocol <strong>v</strong>ersion <strong>4</strong>，缩写：<strong>IPv4</strong>，又称<strong>互联网通信协议第四版</strong>）是<a href="https://zh.wikipedia.org/wiki/%E7%BD%91%E9%99%85%E5%8D%8F%E8%AE%AE">网际协议</a>开发过程中的第四个修订版本，也是此协议第一个被广泛部署和使用的版本。</p><p>IPv4是一种<a href="https://zh.wikipedia.org/wiki/%E7%84%A1%E9%80%A3%E6%8E%A5%E5%BC%8F%E9%80%9A%E8%A8%8A">无连接</a>的协议，操作在使用<a href="https://zh.wikipedia.org/wiki/%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2">分组交换</a>的链路层（如<a href="https://zh.wikipedia.org/wiki/%E4%BB%A5%E5%A4%AA%E7%BD%91">以太网</a>）上。此协议会尽最大努力交付数据包，意即它不保证任何数据包均能送达目的地，也不保证所有数据包均按照正确的顺序无重复地到达。这些方面是由上层的传输协议（如<a href="https://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AE">传输控制协议</a>）处理的。</p></blockquote><p>上边的话显得太专业，可能有的小伙伴会听不懂，其实简而言之IP地址就是给因特网上的每一个主机或路由器的每个接口分配一个在全世界范围内唯一的32位的标识符（其实就差不多相当于我们的电话号码）,一个IP地址在整个因特网范围内都是唯一的。</p><h3 id="分类的IP地址"><a href="#分类的IP地址" class="headerlink" title="分类的IP地址"></a>分类的IP地址</h3><p>首先介绍一下A类、B类、C类网络地址，详见下图<br><img src="https://onedrive.gimhoy.com/1drv/aHR0cHM6Ly8xZHJ2Lm1zL3UvcyFBcGtNdG56TnhsVm9kaXRnWGlUdDZPMmVqNVU=.png"></p><ul><li><p>A类地址中最高位为0，剩下的31位中高7位为网络标识符，主机标识位为24位，意味着每个网络可以容纳1600多万台的主机，A 类占整个地址空间的 50%。 然而，只有 126 个组织可以分配 A 类网络地址。 有趣的是，每个组织都可以为 16,000,000 台主机提供地址。 超大型组织会分配整个 A 类地址块。 时至今日，仍有公司和政府组织拥有 A 类地址。 例如，通用电气公司拥有 3.0.0.0/8，苹果电脑公司拥有 17.0.0.0/8，美国 邮政总局拥有 56.0.0.0/8。</p><p><strong>A类地址范围：0.0.0.0~127.255.255.255</strong></p><p>但由于网络号全0ip地址为本网络，127为回环测试地址，所以实际可用地址为1.0.0.0~126.0.0.0</p></li><li><p>B类IP地址是指，在IP地址的四段号码中，前两段号码为网络号码，剩下的两段号码为本地计算机的号码。如果用二进制表示IP地址的话，B类IP地址就由2字节的网络地址和2字节主机地址组成，网络地址的最高位必须是“10”。B类IP地址中网络的标识长度为14位，主机标识的长度为16位，B类网络地址适用于中等规模规模的网络，每个网络所能容纳的计算机数为6万多台。B 类占整个地址空间的 25%。 最多 16,384 个组织可以分配 B 类网络地址，每个网络可以支持 65,534 台主机。 只有那些特大型的公司/组织或政府部门有可能会使用到所有 65,000 个地址。 与 A 类网络类似，B 类地址空间浪费许多 IP 地址。</p><p><strong>B类地址范围：128.0.0.0~191.255.255.255</strong></p></li><li><p>C类IP地址是指，在IP地址的四段号码中，前三段号码为网络号码，剩下的一段号码为本地计算机的号码。如果用二进制表示IP地址的话，C类IP地址就由3字节的网络地址和1字节主机地址组成，网络地址的最高位必须是“110”。C类IP地址中网络的标识长度为21位，主机标识的长度为8位，C类网络地址数量较多，适用于小规模的局域网络，每个网络最多只能包含254台计算机。   C 类占整个地址空间的 12.5%。 许多组织可以获得 C 类网络，但是限于它们能够连接的主机总数。 事实上，在许多情况下，C 类地址对于大多数中型企业来说通常太小。</p><p><strong>C类地址范围：192.0.0.0~223.255.255.255</strong></p><blockquote><p>在网络中主机号全0与全1的不分配，全0表示本网络地址，全1表示广播地址</p></blockquote><p>主机号不能全0或全为1，全为0时代表本网络，全为1时代表广播地址。</p></li></ul><h4 id="单播、多播、广播"><a href="#单播、多播、广播" class="headerlink" title="单播、多播、广播"></a>单播、多播、广播</h4><p>除了上面三种类型的IP地址外，还有几种特殊类型的IP地址，TCP/IP协议规定，凡IP地址中的第一个字节以“1110”开始的地址都叫多点广播地址。在这里就要说一下单播、广播、多播地址的区别。</p><blockquote><ul><li><p>单播地址是IP网络中最常见的。包含单播目标地址的分组发送给特定主机，一个这样的例子是，IP地址为192.168.1.5（源地址）的主机向IP地址为192.168.1.200（目标地址）的服务器请求网页。要发送和接收单播分组，IP分组报头中必须有一个目标IP地址，而以太网帧报头中必须有相应的目标MAC地址。IP地址和MAC地址一起将数据传输到特定的目标主机。</p></li><li><p>广播分组的目标IP地址的主机部分全为1，这意味着本地网络（广播域）中的所有主机都将接收并查看该分组。诸如ARP和DHCP等很多网络协议都使用广播。</p><p>例如：</p><p>C类网络192.168.1.0的默认子网掩码为255.255.255.0（掩码的255个数对应网络的网络地址个数），其广播地址为192.168.1.255，其主机部分为十进制数255或二进制数11111111（全为1）；</p><p>B类网络172.16.0.0的默认子网掩码为255.255.0.0，其广播地址为172.16.255.255；</p><p>A类网络10.0.0.0的默认子网掩码为255.0.0.0，其广播地址为10.255.255.255。</p><p>在以太网帧中，必须包含与广播IP地址对应的广播MAC地址。在以太网中，广播MAC地址长48位，其十六进制表示为FF-FF-FF-FF-FF-FF（全1为广播mac，主机地址为全1即广播ip地址）</p></li><li><p>多播地址让源设备能够将分组发送给一组设备。属于多播组的设备将被分配一个多播组IP地址，多播地址范围为224.0.0.0～239.255.255.255。由于多播地址表示一组设备（有时被称为主机组），因此只能用作分组的目标地址，源地址总是为单播地址。</p></li></ul></blockquote><p>因此，任何第一个字节大于223小于240的IP地址是多点广播地址；IP地址中的每一个字节都为0的地址（“0.0.0.0”）对应于当前主机；IP地址中的每一个字节都为1的IP地址（“255．255．255．255”）是当前子网的广播地址；IP地址中凡是以“llll0”的地址都留着将来作为特殊用途使用；IP地址中不能以十进制“127”作为开头，127.0.0.1是回送地址，指本地机，一般用来测试使用。回送地址（127.x.x.x）是本机回送地址（Loopback Address）,即主机IP堆栈内部的IP地址，主要用于网络软件测试以及本地机进程间通信，无论什么程序，一旦使用回送地址发送数据，协议软件立即返回之，不进行任何网络传输。 属于保留测试地址,不能用，同时网络ID的第一个6位组也不能全置为“0”，全“0”表示本地网络。   D 类和 E 类用于组播和保留地址。</p><h4 id="子网掩码"><a href="#子网掩码" class="headerlink" title="子网掩码"></a>子网掩码</h4><p>说到子网掩码就不能不提一下子网的概念，在前边的几类地址中比如我们申请到一个c类地址，那么意味着我们最多可以容纳2<sup>8</sup>-2台主机，也就是254台。那么如何对这254台主机进行进一步划分，将其也分为几组地址，这就引出了<strong>子网</strong>的概念</p><blockquote><p>为了确定网络区域，分开主机和路由器的每个接口，从而产生了若干个分离的网络岛，接口端连接了这些独立网络的端点。这些独立的网络岛叫做<strong>子网(subnet)。</strong></p></blockquote><p>同时，A、B、C三类IP地址的默认子网掩码是网络号全为1，主机号为0</p><p>在这里可能看到子网的概念不是很能理解，其实子网就可以看为ip地址中网络号的扩充，可以划分为更多的网络。下边我们来举几个简单的例子。</p><p>比如192.168.1.32，首先它是一个C类地址，默认子网掩码为255.255.255.0，该IP地址的网络号为192.168.1.0，所在的网络里边共有254（2<sup>8</sup>-2）台主机，如果我们想要在这个网络里划分更小的网络就需要<strong>借用</strong>一部分主机号，具体做法就是如果想划分的子网数是2<sup>n</sup>个就需要借用n位高位主机号</p>]]></content>
      
      
      <categories>
          
          <category> 计算机网络 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ip </tag>
            
            <tag> 局域网 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前向代理与反向代理</title>
      <link href="/2019/11/01/qian-xiang-dai-li-yu-fan-xiang-dai-li/"/>
      <url>/2019/11/01/qian-xiang-dai-li-yu-fan-xiang-dai-li/</url>
      
        <content type="html"><![CDATA[<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><p>   代理顾名思义就是自己不去干一件事，让别人帮你去干。同样的，我们在网络上访问一些服务时也需要通过代理去完成，比如有天你想要看某某hub,但是你在China时看不到的，所以此时你便需要一个国外的代理服务器代理你去访问，然后将结果返回给你，然后你就可以嘿嘿嘿了。<br>   <img src="https://img-blog.csdnimg.cn/20190409162703561.gif"></p><p>   在这里便是代理的一种应用，其实代理按照代理的方式一般可分为前向代理与反向代理</p><h2 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h2><ul><li><h3 id="前向代理"><a href="#前向代理" class="headerlink" title="前向代理"></a>前向代理</h3>  我们所见到的大部分情况都是前向代理，A客户端表面上与B服务器进行通信，但是事实上中间可能还经过了B服务器的转发，此时B服务器就起的是代理的作用，代理服务器是面向客户端的。刚开始我们所举的例子就属于前向代理范畴，通常用于访问某些服务受限时，起到了代理转发的作用。</li><li><h3 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h3>  反向代理我们可能见的并不多，但是却起到至关重要的作用，例如著名的Nginx服务器通常就起的是反向代理的作用。当你准备网上购物时，在浏览器地址栏输入taobao.com，域名地址经过DNS服务器解析后便可访问到对应的网站，这只是一个宏观上的过程，事实上在此过程中浏览器拿到服务器ip地址后便向服务器发送http请求，此时接受请求的就是nginx服务器(也可能是其他服务器，例如Apache等)，而nginx接收到请求后自己并不能处理请求，需要将请求转发到对应的web应用层进行处理，在进行完逻辑处理后，web应用层把请求返回给nginx,说：‘nginx，你可以把结果返回到客户端了’，nginx便乖乖的将结果返回到客户端，这便是反向代理在其中所起到的作用，隐匿了真正的业务逻辑层，提高了应用层安全性。<h5 id="主要功能："><a href="#主要功能：" class="headerlink" title="主要功能："></a>主要功能：</h5><ul><li>对客户端隐藏服务器（集群）的IP地址</li><li>安全：作为应用层防火墙，为网站提供对基于Web的攻击行为（例如DoS/DDoS）的防护，更容易排查恶意软件等</li><li>为后端服务器（集群）统一提供加密和SSL加速（如SSL终端代理）</li><li>负载均衡，若服务器集群中有负荷较高者，反向代理通过URL重写，根据连线请求从负荷较低者获取与所需相同的资源或备援</li><li>对于静态内容及短时间内有大量访问请求的动态内容提供缓存服务<br>对一些内容进行压缩，以节约带宽或为网络带宽不佳的网络提供服务</li><li>减速上传</li><li>为在私有网络下（如局域网）的服务器集群提供NAT穿透及外网发布服务</li><li>提供HTTP访问认证[2]</li><li>突破互联网封锁（不常用，因为反向代理与客户端之间的连线不一定是加密连线，非加密连线仍有遭内容审查进而遭封禁的风险；此外面对针对域名的关键字过滤、DNS缓存污染/投毒攻击乃至深度数据包检测也无能为力）<h5 id="常见反向代理软件"><a href="#常见反向代理软件" class="headerlink" title="常见反向代理软件"></a>常见反向代理软件</h5></li><li>Nginx、Tengine</li><li>Apache HTTP Server</li><li>Varnish cache</li><li>Squid Cache</li><li>Traffic Server</li><li>HAProxy</li><li>YXORP</li><li>Polipo</li><li>Privoxy</li><li>IIS<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><a href="https://zh.m.wikipedia.org/zh-hans/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86">维基百科-反向代理</a></li></ul></li></ul><p>​    </p>]]></content>
      
      
      <categories>
          
          <category> 服务器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 代理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>简单TCP服务器构建</title>
      <link href="/2019/11/01/jian-dan-tcp-fu-wu-qi-gou-jian/"/>
      <url>/2019/11/01/jian-dan-tcp-fu-wu-qi-gou-jian/</url>
      
        <content type="html"><![CDATA[<h2 id="一-基本概念"><a href="#一-基本概念" class="headerlink" title="一.基本概念"></a>一.基本概念</h2><ul><li><strong>Socket(套接字）</strong></li></ul><blockquote><p> socket是一种操作系统提供的进程间通信机制。[1] 在操作系统中，通常会为应用程序提供一组应用程序接口（API），称为套接字接口（英语：socket API）。应用程序可以通过套接字接口，来使用网络套接字，以进行数据交换。最早的套接字接口来自于4.2 BSD，因此现代常见的套接字接口大多源自Berkeley套接字（Berkeley sockets）标准。在套接字接口中，以IP地址及通信端口组成套接字地址（socket address）。远程的套接字地址，以及本地的套接字地址完成连线后，再加上使用的协议（protocol），这个五元组（five-element tuple），作为套接字对（socket pairs），之后就可以彼此交换数据。例如，在同一台计算机上，TCP协议与UDP协议可以同时使用相同的port而互不干扰。<br>  操作系统根据套接字地址，可以决定应该将数据送达特定的行程或线程。这就像是电话系统中，以电话号码加上分机号码，来决定通话对象一般。<br> 材料来源：维基百科 </p></blockquote><p> 套接字顾名思义就是像插座一样起到了套接的作用。我们知道当不同的两台计算机进行通信时，需要通过彼此的ip地址进行寻址通信，但是计算机上面运行的软件很多，比如在你开微信的时候还听着歌，那么不同的应用程序进行通信时是如何做到互不影响的呢？这就是端口的用途，或许你觉得你可能用不到这个玩意，当你在网上输入任意一个网址时，浏览器都默认给网址的最后加上<strong>80(http协议通信默认端口)</strong>,程序便可以通过端口进行通信，传递信息。</p><ul><li><strong>TCP协议</strong><br> TCP为传输控制协议，我们所遇到的大部分通信都是基于TCP协议的可靠通信，TCP连接之所以可靠是因为TCP建立的是长连接，创建TCP连接时，主动发起连接的叫客户端，被动响应连接的叫服务器。<h2 id="二-实现原理"><a href="#二-实现原理" class="headerlink" title="二.实现原理"></a>二.实现原理</h2></li><li><strong>创建socket</strong><br><img src="https://img-blog.csdnimg.cn/20190513171805553.png"><br>在这里我们直接导入socket模块，然后创建socket对象，socket类初始化时需要赋参数，因为我们这里创建的是TCP服务，所以就不应改动，如果创建Udp服务时则应该改为family=AF_INET,type=SOCK_DGRAM</li></ul><p> <strong>socket类构建方法参数类型</strong><br><img src="https://img-blog.csdnimg.cn/20190513172445518.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><ul><li>   <strong>客户端请求连接</strong><br>在这里为了简化，我直接使用socket测试工具进行连接，并发送数据‘hello’<br>accept()方法可以返回一个元组，为一个新的套接字与客户端ip地址与端口，之所以需要返回一个新的套接字是因为为了满足下一次的通信需要，如果使用一个套接字时那么当发送来别的请求时将无法继续监听，因为此时的socket正在使用，所以需要新建一个通信管道。<br><img src="https://img-blog.csdnimg.cn/20190513173044910.png"><h2 id="三-方法改进"><a href="#三-方法改进" class="headerlink" title="三.方法改进"></a>三.方法改进</h2>上面我们是从最底层建立TCP连接(即从建立最基本的socket开始),事实上在真正的开发中程序员很少去从最底层做，因为已经有了封装的比较好的类库，从而避免了重复造轮子，在这里我们将使用socketserver模块中的服务基类与请求处理基类实现该功能<br><img src="https://img-blog.csdnimg.cn/20190513174407801.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"><br>这样我们便不用去关心底层建立socket的细节，而只关心业务逻辑的处理，使用TCPServer类有一个缺陷，就是只能为一个客户端服务，是单线程的，当我们想要创建多线程连接时可以使用<strong>ThreadingTCPServer</strong>类来满足。<br>另外，当我们想要去调整底部的socket时可以设置参数<strong>bind_and_activate=False</strong><br><img src="https://img-blog.csdnimg.cn/2019051317493676.png"></li></ul>]]></content>
      
      
      <categories>
          
          <category> 服务器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TCP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python中引用文件的方法</title>
      <link href="/2019/10/31/python-zhong-yin-yong-wen-jian-de-fang-fa/"/>
      <url>/2019/10/31/python-zhong-yin-yong-wen-jian-de-fang-fa/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><hr><p>在程序中引用文件无非是通过两种方式——<strong>绝对路径与相对路径</strong>，但是前者往往因为文件目录的改动而造成引用错误，因此我们大多采用相同路径的文件来引用文件。</p><p>例如，我们当前的目录结构是这样的</p><pre class=" language-python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>GUI    <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>test        <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>demo<span class="token punctuation">.</span>py        <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>file<span class="token punctuation">.</span>json    <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>api<span class="token punctuation">.</span>py</code></pre><p>在demo.py中有函数**read_data()**来读取file.json中的内容</p><pre class=" language-python"><code class="language-python">read_data<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span>mode<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> json_file<span class="token punctuation">:</span>            config<span class="token operator">=</span>json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>json_file<span class="token punctuation">)</span>            <span class="token keyword">return</span> config        <span class="token keyword">except</span> FileNotFoundError <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span></code></pre><p>其中将file_path改为<strong>“./file.json”</strong>即可读取file.json中内容</p><p>那么现在我们在api.py中调用demo.py发现会报如下错误：</p><blockquote><p>找不到file.json</p></blockquote><p>？？？？什么鬼？</p><p>我们的文件路径经过开始的测试没有错误啊，为什么会出现这样的错误？</p><h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><hr><p>事实上，我们的相对文件路径并没有错，当然这是建立在脚本程序和所读文件在相同的目录下，但是由于我们在其他目录下引用了相对路径，那么就会产生一个问题：python解释器在执行api.py时在api.py的父级目录下找不到file.json,因此便会报错，那么有什么方法可以让文件的路径始终保持唯一不变呢？请看下面</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> oscurrent_path<span class="token operator">=</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span>read_data<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>    full_path<span class="token operator">=</span>current_path<span class="token operator">+</span>file_path    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span>full_path<span class="token punctuation">,</span>mode<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> json_file<span class="token punctuation">:</span>            config<span class="token operator">=</span>json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>json_file<span class="token punctuation">)</span>            <span class="token keyword">return</span> config        <span class="token keyword">except</span> FileNotFoundError <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span></code></pre><p>在其中我们对前面的代码进行了改动，加入了**os.path.dirname(<strong>file</strong>)返回了该函数所在的脚本文件的路径,**因而在其他模块中进行调用时便可直接找到该文件</p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>哈夫曼树及哈夫曼编码详解</title>
      <link href="/2019/10/25/ha-fu-man-shu-ji-ha-fu-man-bian-ma-xiang-jie/"/>
      <url>/2019/10/25/ha-fu-man-shu-ji-ha-fu-man-bian-ma-xiang-jie/</url>
      
        <content type="html"><![CDATA[<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><h3 id="哈夫曼编码"><a href="#哈夫曼编码" class="headerlink" title="哈夫曼编码"></a>哈夫曼编码</h3><blockquote><p>在讲哈夫曼树之前先来介绍一下哈夫曼编码的概念。在信息编码、数据压缩等方面，我们总是希望编码能够尽可能的简短一点，如此才能节省空间，提高传输效率。例如：如果采用等长编码的话编码’abcd’,则为00，01，10，11，此时占据8bit的空间，况且各个字符出现的频率还都为一次，如果出现多次则会效率很低；如果采用不等长编码的话则可以为：0，10，110，111，大家肯定会有一个问题：为什么要写成这种形式呢？如果我分别编码为0，1，00，01的话可以吗？那么假如编码串为”001011”的话计算机便不能进行唯一的解码了，因为此时可能的结果有’aababb’,’addb’,’cbdb’,因此如果没有分隔符标注的话便会产生歧义。所以此时引入了一个<strong>前缀编码</strong>的概念——<strong>同一字符集中任何一个字符的编码都不是另外一个字符编码的前缀（最左字串），这种编码称为前缀编码。</strong></p></blockquote><hr><p>在真正压缩的时候我们希望出现频率高的字符所占用较小的编码长度，如果之前你学过离散数学的话应该会听过<strong>最优二叉树</strong>的概念，即让权值小的元素靠近根结点，哈夫曼树便是这个原理。</p><h3 id="哈夫曼树"><a href="#哈夫曼树" class="headerlink" title="哈夫曼树"></a>哈夫曼树</h3><blockquote><p>路径：从树中一个结点到另一个结点之间的分支序列构成两个结点间的路径。</p><p>路径长度：路径上分支的条数称为路径长度。</p><p>树的路径长度：从树根到每个结点的路径长度之和称为树的路径长度。</p><p>结点的权：给树中结点赋予一个数值，该数值称为结点的权。</p><p>带权路径长度：结点到树根间的路径长度与结点权的乘积，称为该结点的带权路径长度。</p><p>树的带权路径长度：树中所有叶子结点的带权路径长度之和，称为树的带权路径长度，通常记为WPL</p><p>​                                                          <img src="https://private.codecogs.com/gif.latex?WPL=%20%5Csum_%7Bk=1%7D%5E%7Bn%7DW_%7Bk%7D*L_%7Bk%7D"></p><p>注：n为叶子结点个数（所要编码的字符数）</p></blockquote><p>在这里，最优二叉树的写法不在赘述，具体可参考：<a href="https://jingyan.baidu.com/article/380abd0a717c061d90192ca2.html">https://jingyan.baidu.com/article/380abd0a717c061d90192ca2.html</a></p><h2 id="哈夫曼树的建立与编译码"><a href="#哈夫曼树的建立与编译码" class="headerlink" title="哈夫曼树的建立与编译码"></a>哈夫曼树的建立与编译码</h2><h3 id="存储结构"><a href="#存储结构" class="headerlink" title="存储结构"></a>存储结构</h3><p>哈夫曼树中没有度为1的结点，故n个叶子的哈夫曼树，恰有n-1个度为2的结点，所以哈夫曼树共有2n-1个结点，可以存储在一个大小为2n-1的一维数组中。</p><table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>Weight</td><td>Parent</td><td>Lchild</td><td>Rchild</td></tr></tbody></table><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//结构声明</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> point<span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> weight<span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">//权值</span>    <span class="token keyword">int</span> parent<span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">//父节点下标</span>    <span class="token keyword">char</span> data<span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">//编码字母</span>    <span class="token keyword">int</span> code<span class="token punctuation">;</span>           <span class="token keyword">int</span> lchild<span class="token punctuation">,</span>rchild<span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>HuffmanNode<span class="token punctuation">;</span></code></pre><h3 id="建立哈夫曼树"><a href="#建立哈夫曼树" class="headerlink" title="建立哈夫曼树"></a>建立哈夫曼树</h3><p>​     1.在建立前我们需要对每个字符求其权值，在这里我们以字符出现的频度作为权值的衡量标准。</p><pre class=" language-cpp"><code class="language-cpp">HuffmanNode <span class="token operator">*</span><span class="token function">Compute_weight</span><span class="token punctuation">(</span>HuffmanNode <span class="token operator">*</span>p<span class="token punctuation">,</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">//计算权值</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>p<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>                p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>weight<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>   2.利用其权值大小创建哈夫曼树</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">Build_HuffmanTree</span><span class="token punctuation">(</span>HuffmanNode <span class="token operator">*</span>p<span class="token punctuation">,</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">//建立哈夫曼树</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> s1<span class="token punctuation">,</span>s2<span class="token punctuation">,</span><span class="token operator">*</span>min<span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">2</span><span class="token operator">*</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        min<span class="token operator">=</span><span class="token function">SearchMinNumbers</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>i<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        s1<span class="token operator">=</span><span class="token operator">*</span>min<span class="token punctuation">;</span>        s2<span class="token operator">=</span><span class="token operator">*</span><span class="token punctuation">(</span>min<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>weight<span class="token operator">=</span>p<span class="token punctuation">[</span>s1<span class="token punctuation">]</span><span class="token punctuation">.</span>weight<span class="token operator">+</span>p<span class="token punctuation">[</span>s2<span class="token punctuation">]</span><span class="token punctuation">.</span>weight<span class="token punctuation">;</span>        p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>lchild<span class="token operator">=</span>s1<span class="token punctuation">;</span>        p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>rchild<span class="token operator">=</span>s2<span class="token punctuation">;</span>        p<span class="token punctuation">[</span>s1<span class="token punctuation">]</span><span class="token punctuation">.</span>parent<span class="token operator">=</span>i<span class="token punctuation">;</span>        p<span class="token punctuation">[</span>s2<span class="token punctuation">]</span><span class="token punctuation">.</span>parent<span class="token operator">=</span>i<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>3.哈夫曼树编码</p><p>​      此时我们规定左分支表示‘0’，右分支表示‘1’，用根结点到叶子结点路径上的分支符号组成的串，作为叶子节点字符的编码，这就是哈夫曼编码。</p><pre class=" language-cpp"><code class="language-cpp">HuffmanNode <span class="token function">ResolveHuffmanCode</span><span class="token punctuation">(</span>HuffmanNode <span class="token operator">*</span>p<span class="token punctuation">,</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">//打印字符编码</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    HuffmanNode ptemp<span class="token punctuation">;</span>    <span class="token keyword">char</span> <span class="token operator">*</span>code<span class="token punctuation">;</span>    <span class="token keyword">int</span> start<span class="token punctuation">,</span>pre<span class="token punctuation">;</span>    code<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">mallco</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token operator">*</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>    code<span class="token punctuation">[</span>n<span class="token number">-1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'\0'</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        start<span class="token operator">=</span>n<span class="token number">-1</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        ptemp<span class="token operator">=</span>i<span class="token punctuation">;</span>        pre<span class="token operator">=</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>parent<span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>pre<span class="token punctuation">)</span>        <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span>pre<span class="token punctuation">]</span><span class="token punctuation">.</span>lchild<span class="token operator">==</span>ptemp<span class="token punctuation">)</span>                code<span class="token punctuation">[</span>start<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'0'</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                code<span class="token punctuation">[</span>start<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'1'</span><span class="token punctuation">;</span>            ptemp<span class="token operator">=</span>pre<span class="token punctuation">;</span>            pre<span class="token operator">=</span>p<span class="token punctuation">[</span>ptemp<span class="token punctuation">]</span><span class="token punctuation">.</span>parent<span class="token punctuation">;</span>            start<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>4.哈夫曼树译码</p><p>哈夫曼译码过程较为简单，可按照编码表采用朴素字符串比对的方法进行解码，但是建议采用KMP算符进行字符串匹配，效率较高。</p>]]></content>
      
      
      <categories>
          
          <category> 数据结构与算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 哈夫曼树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python爬虫之有道翻译</title>
      <link href="/2019/10/22/python-pa-chong-zhi-you-dao-fan-yi/"/>
      <url>/2019/10/22/python-pa-chong-zhi-you-dao-fan-yi/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>自从学了python之后，终于明白了那句“人生苦短，我用python”是什么意思了，哈哈，废话不多说，下文正式开始模拟用户翻译过程。</p><h2 id="审查请求元素"><a href="#审查请求元素" class="headerlink" title="审查请求元素"></a>审查请求元素</h2><p>我们在浏览网站时，往往会需要从网站服务器上请求或者向网站服务器提交一些数据，此时我们的浏览器主要向服务器发送get请求来获取数据，或者发送post请求来提交数据，简而言之，我们可以将这样的用户使用情景模拟出来，下面以有道翻译为例：</p><p><img src="https://img-blog.csdnimg.cn/20190206164514445.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p>在图中可以看到，当用户点击翻译按钮时，浏览器会自动以form_data的形式向服务器发起post请求，发送一些翻译需要的信息，而服务器在接受到请求后会对该请求进行校验，如果检测到是以代码程序的形式进行请求则会进行限制（这个事实上我们填写headers就ok了），或者同一个ip在短时间内大量访问就会被直接封掉（这个问题我们此时不考虑）。在识别为合法的请求后服务器会将结果返回客户端，一般情况下都是json格式</p><p><img src="https://img-blog.csdnimg.cn/2019020617113187.png"></p><p>此时我们将相关信息提取出来copy到代码里。</p><h2 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request  <span class="token comment" spellcheck="true">#导入模块</span><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse<span class="token keyword">import</span> jsoncontent<span class="token operator">=</span>input<span class="token punctuation">(</span><span class="token string">"请输入要翻译的内容："</span><span class="token punctuation">)</span>head<span class="token operator">=</span><span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;&amp;#125;   #请求头信息</span>head<span class="token punctuation">[</span><span class="token string">'User-Agent'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36'</span>url<span class="token operator">=</span><span class="token string">'http://fanyi.youdao.com/translate?smartresult=dict&amp;smartresult=rule'</span>data<span class="token operator">=</span><span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;&amp;#125;    #请求表单</span>data<span class="token punctuation">[</span><span class="token string">'i'</span><span class="token punctuation">]</span><span class="token operator">=</span>contentdata<span class="token punctuation">[</span><span class="token string">'from'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'AUTO'</span>data<span class="token punctuation">[</span><span class="token string">'to'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'AUTO'</span>data<span class="token punctuation">[</span><span class="token string">'smartresult'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'dict'</span>data<span class="token punctuation">[</span><span class="token string">'client'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'fanyideskweb'</span>data<span class="token punctuation">[</span><span class="token string">'salt'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'15494388925757'</span>data<span class="token punctuation">[</span><span class="token string">'sign'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'00b84e93f30570e331c01318f59a47f0'</span>data<span class="token punctuation">[</span><span class="token string">'ts'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'1549438892575'</span>data<span class="token punctuation">[</span><span class="token string">'bv'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'e40fbeed3cd61fe519ae6051fcce0429'</span>data<span class="token punctuation">[</span><span class="token string">'doctype'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'json'</span>data<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'2.1'</span>data<span class="token punctuation">[</span><span class="token string">'keyfrom'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'fanyi.web'</span>data<span class="token punctuation">[</span><span class="token string">'action'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'FY_BY_CLICKBUTTION'</span>data<span class="token punctuation">[</span><span class="token string">'typoResult'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'false'</span>data<span class="token operator">=</span>urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>urlencode<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>req<span class="token operator">=</span>urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token punctuation">,</span>head<span class="token punctuation">)</span>response<span class="token operator">=</span>urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>req<span class="token punctuation">)</span>html<span class="token operator">=</span>response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>trans<span class="token operator">=</span>json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>html<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#加载为json字典对象</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"翻译结果:"</span><span class="token punctuation">,</span>trans<span class="token punctuation">[</span><span class="token string">'translateResult'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tgt'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p>url信息我们在post请求中就可以找到，需要注意的是有道翻译的url里边有’_o’的话去掉，应该是对接口进行了升级，我们用旧的接口就好了，data是一个字典，我们直接将form表单中元素copy过来就好了，在这里我们也可以不使用head，直接对url进行请求，但是此种做法容易使得服务器判断出来是机器在爬取而被直接屏蔽，因此我们最好配置user-agent信息。此外<strong>req=urllib.request.Request(url,data,head)<strong>使用了request类，来对我们的请求头进行包装，为请求增加了head信息，使得爬虫更加安全，</strong>但是最安全的方法则是控制访问的时间或者使用代理ip.</strong></p><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://img-blog.csdnimg.cn/20190206170647280.png"></p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>java构造器调用顺序</title>
      <link href="/2019/10/21/java-gou-zao-qi-diao-yong-shun-xu/"/>
      <url>/2019/10/21/java-gou-zao-qi-diao-yong-shun-xu/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天在看书的时候，看到了关于继承的知识，突然觉得之前的理解还是不够，就想着把学到的关于构造器的知识记录下来</p><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>相信大部分人都知道java里边的构造器在做一件什么样的事———创建实例对象时进行初始化，比如：</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> String name<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>     <span class="token keyword">public</span> <span class="token keyword">boolean</span> is_man<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span> <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>       Test test<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>上边这段代码在做着一件简简单单的事情，在堆内存中申请一块内存，创建类的实体对象并为变量赋初值（数值型为0，布尔型为false）。很多人会认为执行构造器方法就是在创建方法，事实上在构造器方法执行前系统已经创建了对象，只不过该对象当前还不能被外界访问而已，构造器函数当前只是执行了成员变量的初始化功能。</p><h2 id="继承中的构造器"><a href="#继承中的构造器" class="headerlink" title="继承中的构造器"></a>继承中的构造器</h2><p>在这里有一个很典型的例子</p><pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Animal</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">final</span> String msg<span class="token operator">=</span><span class="token string">"I'am animal"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">Animal</span><span class="token punctuation">(</span>String name<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token operator">+</span><span class="token string">" belongs to animal"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Human</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">final</span> String msg<span class="token operator">=</span><span class="token string">"I'am human"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">Human</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">Human</span><span class="token punctuation">(</span><span class="token keyword">int</span> history<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token string">"horse"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Human society has a long history about "</span><span class="token operator">+</span>history<span class="token operator">+</span><span class="token string">" years"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Woman</span> <span class="token keyword">extends</span> <span class="token class-name">Human</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">final</span> String msg<span class="token operator">=</span><span class="token string">"I'am a woman"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">Woman</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>上边的程序生动的展现了类继承树中构造器方法的调用顺序，当创建一个子类对象时，系统会依次向上回溯，从继承树顶端的Object类的构造器开始执行，依次往下执行，当在子类中显式调用重载的父类构造器函数时，便不再执行默认的构造器，如果未显式调用时则执行默认的构造器函数，上面代码的执行结果如下：</p><pre><code>horse belongs to animalHuman society has a long history about 5000 yearsI'am a woman</code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw=="></p><p>最后，重要的事情说三遍：</p><p><strong>创建子类对象时没有创建父类对象，只是执行了父类的构造器函数！</strong></p><p><strong>创建子类对象时没有创建父类对象，只是执行了父类的构造器函数！</strong></p><p><strong>创建子类对象时没有创建父类对象，只是执行了父类的构造器函数！</strong></p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> 构造器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>==、equals、hashcode的区别</title>
      <link href="/2019/10/10/equals-hashcode-de-qu-bie/"/>
      <url>/2019/10/10/equals-hashcode-de-qu-bie/</url>
      
        <content type="html"><![CDATA[<p>​    许多人对于==，equals、hashcode的概念不能准确区分，主要是因为没明白这几个的使用情景，刚开始我看到这里的时候也是一头雾水，后来看到了《疯狂java讲义》的内容后顿时才觉得醍醐灌顶。</p><h2 id="与equals的区别"><a href="#与equals的区别" class="headerlink" title="==与equals的区别"></a>==与equals的区别</h2><p>说到==与equals的区别就要先明白这两个的作用，当比较的变量类型是基本数据类型时，==与equals都比较的是其值的大小，当比较的变量类型是引用类型时，==比较的是对象的地址是否相同，而equals也是比较的是对象的地址，这是因为默认情况下都是调用<strong>Object类</strong>的equals方法，下面是Object类的equals方法。</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span>Object obj<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><p>那么可不可以让equals方法不是比较对象的地址呢，答案是可以的，那么就需要对equals方法进行重写，<strong>String类</strong>就重写了equals方法，其重写逻辑如下：</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span>Object anObject<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> anObject<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>anObject <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            String anotherString <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span>anObject<span class="token punctuation">;</span>            <span class="token keyword">int</span> n <span class="token operator">=</span> value<span class="token punctuation">.</span>length<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> anotherString<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>                <span class="token keyword">char</span> v1<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>                <span class="token keyword">char</span> v2<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> anotherString<span class="token punctuation">.</span>value<span class="token punctuation">;</span>                <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                <span class="token keyword">while</span> <span class="token punctuation">(</span>n<span class="token operator">--</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>v1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> v2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>                        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                    i<span class="token operator">++</span><span class="token punctuation">;</span>                <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><p>在重写的equals方法中首先进行了如下步骤：</p><ol><li>A==B时，即A、B为同一个对象，直接返回true</li><li>目标对象类型为String类的类或其派生类时继续比较，否则返回false</li><li>比较两个字符串长度是否一致，长度一致时进行下一步比较，否则返回false</li><li>将两个字符串对象的字符逐个进行比较，若全部相等时返回true，否则返回false</li></ol><h2 id="hashCode"><a href="#hashCode" class="headerlink" title="hashCode"></a>hashCode</h2><p>hashCode()方法返回的是一个数值，在java中采用了特定的哈希算法，从而保证了每个对象在内存中都存放在唯一的一个位置，Object类提供的默认实现保证每个对象的hash码不同（在对象的内存地址基础上经过特定算法返回一个hash码）。</p><p>有以下结论：</p><ol><li>如果两个对象equals，Java运行时环境会认为他们的hashcode一定相等。 </li><li>如果两个对象不equals，他们的hashcode有可能相等。 </li><li>如果两个对象hashcode相等，他们不一定equals。 </li><li>如果两个对象hashcode不相等，他们一定不equals。 </li></ol><p>在这里有两个重要的规范：</p><ul><li>若重写equals(Object obj)方法，有必要重写hashcode()方法，确保通过equals(Object obj)方法判断结果为true的两个对象具备相等的hashcode()返回值。</li><li>如果equals(Object obj)返回false，即两个对象“不相同”，并不要求对这两个对象调用hashcode()方法得到两个不相同的数。</li></ul>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java中线程礼让</title>
      <link href="/2019/09/15/sleep-yu-yield-de-qu-bie/"/>
      <url>/2019/09/15/sleep-yu-yield-de-qu-bie/</url>
      
        <content type="html"><![CDATA[<h2 id="线程礼让机制"><a href="#线程礼让机制" class="headerlink" title="线程礼让机制"></a>线程礼让机制</h2><p>在多线程中常常需要进行线程之间的礼让，或者是某个线程需要等待另外一个线程的计算结果，或者是需要让某个线程暂停执行，通常可以使用wait()、sleep()、yield()、join()等方法实现。</p><h2 id="wait"><a href="#wait" class="headerlink" title="wait()"></a>wait()</h2><p>​        wait()方法常常与notify()及notifyAll()两个方法一起使用，这三个方法用于协调多个线程对共享数据的存取，所以必须在synchronized语句块内使用，也就是说，调用wait()，notify()和notifyAll()的任务在调用这些方法前必须拥有对象的锁。需要注意的是，它们都是Object类的方法，而不是Thread类的方法。<br>　　wait()方法与sleep()方法的不同之处在于，wait()方法会释放对象的“锁标志”。当调用某一对象的wait()方法后，会使当前线程暂停执行，并释放当前线程所持有的锁，接下来将当前线程放入对象等待池中，直到调用了notify()方法后，将从对象等待池中移出任意一个线程并放入锁标志等待池中，只有锁标志等待池中的线程可以获取锁标志，它们随时准备争夺锁的拥有权。当调用了某个对象的notifyAll()方法，会将对象等待池中的所有线程都移动到该对象的锁标志等待池。<br>　　除了使用notify()和notifyAll()方法，还可以使用带毫秒参数的wait(long timeout)方法，效果是在延迟timeout毫秒后，被暂停的线程将被恢复到锁标志等待池。<br>　　此外，wait()，notify()及notifyAll()只能在synchronized语句中使用，但是如果使用的是ReenTrantLock实现同步，该如何达到这三个方法的效果呢？解决方法是使用ReenTrantLock.newCondition()获取一个Condition类对象，然后Condition的await()，signal()以及signalAll()分别对应上面的三个方法。</p><h2 id="sleep"><a href="#sleep" class="headerlink" title="sleep()"></a>sleep()</h2><p>​        sleep()方法的作用是让当前的线程进行休眠操作，其参数为休眠时间，当执行sleep方法时，线程就会进入到阻塞状态，需要注意的是sleep()方法不会释放锁标志。 sleep 方法使当前运行中的线程睡眼一段时间，进入不可运行状态，这段时间的长短是由程序设定的。</p><h2 id="yield"><a href="#yield" class="headerlink" title="yield()"></a>yield()</h2><p>​        yield()方法和sleep()方法类似，也不会释放“锁标志”，区别在于，它没有参数，即yield()方法只是使当前线程重新回到可执行状态，所以执行yield()的线程有可能在进入到可执行状态后马上又被执行，另外yield()方法只能使同优先级或者高优先级的线程得到执行机会，这也和sleep()方法不同。</p><h2 id="wait-与sleep-的区别"><a href="#wait-与sleep-的区别" class="headerlink" title="wait()与sleep()的区别"></a>wait()与sleep()的区别</h2><ol><li>wait只能在同步（synchronize）环境中被调用，而sleep不需要。</li><li>进入wait状态的线程能够被notify和notifyAll线程唤醒，但是进入sleeping状态的线程不能被notify方法唤醒。</li><li>wait通常有条件地执行，线程会一直处于wait状态，直到某个条件变为真，但是sleep仅仅让你的线程进入睡眠状态。</li><li>wait方法在进入wait状态的时候会释放对象的锁，但是sleep方法不会。</li><li>wait方法是针对一个被同步代码块加锁的对象，而sleep是针对一个线程。</li></ol><h2 id="sleep-与yield-的区别"><a href="#sleep-与yield-的区别" class="headerlink" title="sleep()与yield()的区别"></a>sleep()与yield()的区别</h2><ol><li>sleep方法会给其他线程运行的机会，而不考虑其他线程的优先级，因此会给较低优先级的一个运行的机会，yield方法只会给相同优先级或者更高优先级的线程一个运行的机会。</li><li>当线程执行了sleep方法后，将转到阻塞状态，参数millis指定睡眠时间，当线程执行yield方法后，将转到就绪状态。</li><li>sleep方法声明抛出InterruptedException异常，而yield方法没有声明抛出任何异常。</li><li>sleep方法比yield方法具有更好的可移植性，不能优先yield()方法来提高程序的并发性能，对于大多数程序员来说，yield方法的惟一用途是在测试期间人为地提高程序的并发性能，以帮助发现一些隐藏的错误。</li></ol>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 多线程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git详细步骤</title>
      <link href="/2019/06/05/git-xiang-xi-bu-zou/"/>
      <url>/2019/06/05/git-xiang-xi-bu-zou/</url>
      
        <content type="html"><![CDATA[<p><strong>基本用法</strong></p><p><img src="https://img-blog.csdnimg.cn/20191014104801597.png"></p><p>上面的四条命令在工作目录、暂存目录(也叫做索引)和仓库之间复制文件</p><ol><li>git add <em>files</em> 把当前文件放入暂存区域</li><li>git commit 给暂存区域生成快照并提交</li><li>git reset – <em>files</em> 用来撤销最后一次git add <em>files</em>，你也可以用git reset 撤销所有暂存区域文件</li><li>git checkout – <em>files</em> 把文件从暂存区域复制到工作目录，用来丢弃本地修改</li></ol><p><strong>你可以用</strong> <strong>git reset -p,</strong> <strong>git checkout -p, or</strong> <strong>git add -p进入交互模式。</strong></p><p><strong>也可以跳过暂存区域直接从仓库取出文件或者直接提交代码。</strong></p><p><img src="https://img-blog.csdnimg.cn/20191014104801637.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p><strong>命令详解</strong></p><p><strong>Diff</strong></p><p>查看两次提交之间的变动</p><p><img src="https://img-blog.csdnimg.cn/20191014104801640.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p><strong>Commit</strong></p><p>提交时，git用暂存区域的文件创建一个新的提交，并把此时的节点设为父节点。然后把当前分支指向新的提交节点。下图中，当前分支是<em>master</em>。 在运行命令之前，<em>master</em>指向<em>ed489</em>，提交后，<em>master</em>指向新的节点<em>f0cec</em>并以<em>ed489</em>作为父节点。</p><p><img src="https://img-blog.csdnimg.cn/20191014104801651.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p>即便当前分支是某次提交的祖父节点，git会同样操作。下图中，在<em>master</em>分支的祖父节点<em>maint</em>分支进行一次提交，生成了<em>1800b</em>。 这样，<em>maint</em>分支就不再是<em>master</em>分支的祖父节点。此时合并(或者衍合) 是必须的。</p><p><img src="https://img-blog.csdnimg.cn/20191014104801664.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p>如果想更改一次提交，使用 git commit –amend。git会使用与当前提交相同的父节点进行一次新提交，旧的提交会被取消。</p><p><img src="https://img-blog.csdnimg.cn/20191014104801663.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p>另一个例子是分离HEAD提交,后文讲。</p><p><strong>Checkout</strong></p><p>checkout命令用于从历史提交（或者暂存区域）中拷贝文件到工作目录，也可用于切换分支。</p><p>当给定某个文件名（或者打开-p选项，或者文件名和-p选项同时打开）时，git会从指定的提交中拷贝文件到暂存区域和工作目录。比如，git checkout HEAD~ foo.c会将提交节点<em>HEAD~</em>(即当前提交节点的父节点)中的foo.c复制到工作目录并且加到暂存区域中。（如果命令中没有指定提交节点，则会从暂存区域中拷贝内容。）注意当前分支不会发生变化。</p><p><img src="https://img-blog.csdnimg.cn/2019101410480124.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p>当不指定文件名，而是给出一个（本地）分支时，那么<em>HEAD</em>标识会移动到那个分支（也就是说，我们”切换”到那个分支了），然后暂存区域和工作目录中的内容会和<em>HEAD</em>对应的提交节点一致。新提交节点（下图中的a47c3）中的所有文件都会被复制（到暂存区域和工作目录中）；只存在于老的提交节点（ed489）中的文件会被删除；不属于上述两者的文件会被忽略，不受影响。</p><p><img src="https://img-blog.csdnimg.cn/20191014104801690.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p>如果既没有指定文件名，也没有指定分支名，而是一个标签、远程分支、SHA-1值或者是像<em>master~3</em>类似的东西，就得到一个匿名分支，称作<em>detached HEAD</em>（被分离的<em>HEAD</em>标识）。这样可以很方便地在历史版本之间互相切换。比如说你想要编译1.6.6.1版本的git，你可以运行git checkout v1.6.6.1（这是一个标签，而非分支名），编译，安装，然后切换回另一个分支，比如说git checkout master。然而，当提交操作涉及到”分离的HEAD”时，其行为会略有不同，详情见在下面。</p><p><img src="https://img-blog.csdnimg.cn/20191014104801694.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p><strong>HEAD标识处于分离状态时的提交操作</strong></p><p>当<em>HEAD</em>处于分离状态（不依附于任一分支）时，提交操作可以正常进行，但是不会更新任何已命名的分支。(你可以认为这是在更新一个匿名分支。)</p><p><img src="https://img-blog.csdnimg.cn/20191014104801714.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p>一旦此后你切换到别的分支，比如说<em>master</em>，那么这个提交节点（可能）再也不会被引用到，然后就会被丢弃掉了。注意这个命令之后就不会有东西引用<em>2eecb</em>。</p><p><img src="https://img-blog.csdnimg.cn/20191014104801730.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p>但是，如果你想保存这个状态，可以用命令git checkout -b <em>name</em>来创建一个新的分支。</p><p><img src="https://img-blog.csdnimg.cn/20191014104801758.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p><strong>Reset</strong></p><p>eset 命令把当前分支指向另一个位置，并且有选择的变动工作目录和索引。也用来在从历史仓库中复制文件到索引，而不动工作目录。</p><p>如果不给选项，那么当前分支指向到那个提交。如果用–hard选项，那么工作目录也更新，如果用–soft选项，那么都不变。</p><p><img src="https://img-blog.csdnimg.cn/20191014104801766.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p>如果没有给出提交点的版本号，那么默认用<em>HEAD</em>。这样，分支指向不变，但是索引会回滚到最后一次提交，如果用–hard选项，工作目录也同样。</p><p><img src="https://img-blog.csdnimg.cn/20191014104801783.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p>如果给了文件名(或者 -p选项), 那么工作效果和带文件名的 heckout 差不多，除了索引被更新。</p><p><img src="https://img-blog.csdnimg.cn/20191014104801136.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p><strong>Merge</strong></p><p>merge 命令把不同分支合并起来。合并前，索引必须和当前提交相同。如果另一个分支是当前提交的祖父节点，那么合并命令将什么也不做。 另一种情况是如果当前提交是另一个分支的祖父节点，就导致<em>fast-forward</em>合并。指向只是简单的移动，并生成一个新的提交。</p><p><img src="https://img-blog.csdnimg.cn/20191014104801814.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p>否则就是一次真正的合并。默认把当前提交(<em>ed489</em> 如下所示)和另一个提交(<em>33104</em>)以及他们的共同祖父节点(<em>b325c</em>)进行一次<a href="http://en.wikipedia.org/wiki/Three-way_merge">三方合并</a>。结果是先保存当前目录和索引，然后和父节点<em>33104</em>一起做一次新提交。</p><p><img src="https://img-blog.csdnimg.cn/20191014104801824.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p><strong>Cherry Pick</strong></p><p>cherry-pick命令”复制”一个提交节点并在当前分支做一次完全一样的新提交。</p><p><img src="https://img-blog.csdnimg.cn/20191014104801850.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p><strong>Rebase</strong></p><p>衍合是合并命令的另一种选择。合并把两个父分支合并进行一次提交，提交历史不是线性的。衍合在当前分支上重演另一个分支的历史，提交历史是线性的。 本质上，这是线性化的自动的 cherry-pick</p><p><img src="https://img-blog.csdnimg.cn/20191014104801874.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p>上面的命令都在<em>topic</em>分支中进行，而不是<em>master</em>分支，在<em>master</em>分支上重演，并且把分支指向新的节点。注意旧提交没有被引用，将被回收。</p><p>要限制回滚范围，使用–onto选项。下面的命令在<em>master</em>分支上重演当前分支从<em>169a6</em>以来的最近几个提交，即<em>2c33a</em>。</p><p><img src="https://img-blog.csdnimg.cn/20191014104801877.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZfSVRfYm95,size_16,color_FFFFFF,t_70"></p><p>同样有git rebase –interactive让你更方便的完成一些复杂操作，比如丢弃、重排、修改、合并提交。没有图片体现这些，细节看这里:<a href="http://www.kernel.org/pub/software/scm/git/docs/git-rebase.html#_interactive_mode">git-rebase(1)</a></p><p><strong>技术说明</strong></p><p>文件内容并没有真正存储在索引(<em>.git/index</em>)或者提交对象中，而是以blob的形式分别存储在数据库中(<em>.git/objects</em>)，并用SHA-1值来校验。 索引文件用识别码列出相关的blob文件以及别的数据。对于提交来说，以树(<em>tree</em>)的形式存储，同样用对于的哈希值识别。树对应着工作目录中的文件夹，树中包含的 树或者blob对象对应着相应的子目录和文件。每次提交都存储下它的上一级树的识别码。</p><p>如果用detached HEAD提交，那么最后一次提交会被the reflog for HEAD引用。但是过一段时间就失效，最终被回收，与git commit –amend或者git rebase很像。</p>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>队列与堆栈的两种实现</title>
      <link href="/2019/06/03/dui-lie-yu-dui-zhan-de-liang-chong-shi-xian/"/>
      <url>/2019/06/03/dui-lie-yu-dui-zhan-de-liang-chong-shi-xian/</url>
      
        <content type="html"><![CDATA[<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>这篇博文主要是回顾了一下之前数据结构的知识，使用单链表与数组的方式分别实现了堆栈与队列。</p><h3 id="逻辑结构与物理结构"><a href="#逻辑结构与物理结构" class="headerlink" title="逻辑结构与物理结构"></a>逻辑结构与物理结构</h3><p>逻辑结构顾名思义就是人们抽象出来的结构，通常包含</p><ul><li>集合结构：集合结构的集合中任何两个数据元素之间都没有逻辑关系，组织形式松散</li><li>线性结构：数据结构中线性结构指的是数据元素之间存在着“一对一”的线性关系的数据结构</li><li>图结构</li><li>树状结构：树状结构是一个或多个节点的有限集合</li></ul><p>其中习惯分为两类——<strong>线性结构</strong>与<strong>非线性结构</strong>（集合结构、树、图）</p><p>而物理结构就是数据实际的存储结构包括顺序存储结构（数组）与链式存储结构（链表等），因此分别采用两种存储结构实现栈与队列。</p><h3 id="栈与队列"><a href="#栈与队列" class="headerlink" title="栈与队列"></a>栈与队列</h3><p><strong>堆栈</strong>是一种先进后出的结构，生活中的例子似乎不太多，不过还是有一些例子，比如一摞碗，每次取的时候总是取得最上边的碗，最下边的碗总是最后一个被取走。<strong>队列</strong>是一种先进先出的结构，生活中例子很多，最常见的就是排队了，排在前边的人先被服务，后边的人最后被服务。</p><h2 id="节点结构与接口声明"><a href="#节点结构与接口声明" class="headerlink" title="节点结构与接口声明"></a>节点结构与接口声明</h2><p>每个节点有数据域与指针域，栈与队列类实现了添加、弹出、求长度、判断为空等接口方法</p><h3 id="节点结构"><a href="#节点结构" class="headerlink" title="节点结构"></a>节点结构</h3><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//节点类</span><span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> Object data<span class="token punctuation">;</span>    <span class="token keyword">public</span> Node next<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">Node</span><span class="token punctuation">(</span>Object data<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token operator">=</span>data<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">Node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> String<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><h3 id="接口声明"><a href="#接口声明" class="headerlink" title="接口声明"></a>接口声明</h3><pre class=" language-java"><code class="language-java"><span class="token keyword">interface</span> <span class="token class-name">Stack</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/*堆栈接口*/</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span>Node node<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//压入堆栈</span>    <span class="token keyword">public</span> Node <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//弹出堆栈</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">Length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//计算堆栈元素个数</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">indexOf</span><span class="token punctuation">(</span>Node node<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">//求元素索引1</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">//判断堆栈是否为空</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token keyword">interface</span> <span class="token class-name">Queue</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//队列接口声明</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">Length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//队列长度</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">//队列是否为空</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">indexOf</span><span class="token punctuation">(</span>Node node<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">//求某个元素索引</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span>Node node<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//添加元素</span>    <span class="token keyword">public</span> Node <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">;</span>             <span class="token comment" spellcheck="true">//弹出元素</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><h2 id="堆栈"><a href="#堆栈" class="headerlink" title="堆栈"></a>堆栈</h2><h3 id="链表结构（头插法）"><a href="#链表结构（头插法）" class="headerlink" title="链表结构（头插法）"></a>链表结构（头插法）</h3><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//堆栈类（单链表-头插法）</span><span class="token keyword">class</span> <span class="token class-name">StackList</span> <span class="token keyword">implements</span> <span class="token class-name">Stack</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> Node head<span class="token operator">=</span>null<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">StackList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        head<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//初始化头指针</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span>Node node<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        Node temp<span class="token operator">=</span>head<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        head<span class="token punctuation">.</span>next<span class="token operator">=</span>node<span class="token punctuation">;</span>        node<span class="token punctuation">.</span>next<span class="token operator">=</span>temp<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">indexOf</span><span class="token punctuation">(</span>Node node<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">//队列为空报错</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"当前队列为空，请先添加元素！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//循环计数器</span>        <span class="token keyword">boolean</span> isMatch<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//是否匹配成功标志</span>        Node temp<span class="token operator">=</span>head<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>temp<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>temp<span class="token operator">==</span>node<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//地址相同即为相同对象</span>                isMatch<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>            temp<span class="token operator">=</span>temp<span class="token punctuation">.</span>next<span class="token punctuation">;</span>            i<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isMatch<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"当前队列没有该元素！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> i<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> Node <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>head<span class="token punctuation">.</span>next<span class="token operator">==</span>null<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"当前堆栈为空！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        Node temp<span class="token operator">=</span>head<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        head<span class="token punctuation">.</span>next<span class="token operator">=</span>head<span class="token punctuation">.</span>next<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token keyword">return</span> temp<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">Length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>        Node temp<span class="token operator">=</span>head<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>temp<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            temp<span class="token operator">=</span>temp<span class="token punctuation">.</span>next<span class="token punctuation">;</span>            i<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> i<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> head<span class="token punctuation">.</span>next<span class="token operator">==</span>null<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><h3 id="数组结构"><a href="#数组结构" class="headerlink" title="数组结构"></a>数组结构</h3><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//堆栈类（数组实现）</span><span class="token keyword">class</span> <span class="token class-name">StackArray</span> <span class="token keyword">implements</span> <span class="token class-name">Stack</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">//当前堆栈中元素个数</span>    <span class="token keyword">private</span> Node<span class="token punctuation">[</span><span class="token punctuation">]</span> head<span class="token operator">=</span>null<span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">//数组首指针</span>    <span class="token keyword">public</span> <span class="token function">StackArray</span><span class="token punctuation">(</span><span class="token keyword">int</span> maxsize<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        head<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">[</span>maxsize<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span>Node node<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>size<span class="token operator">&gt;=</span>head<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"堆栈已满！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        head<span class="token punctuation">[</span>size<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>node<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> Node <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"堆栈为空！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> head<span class="token punctuation">[</span><span class="token operator">--</span>size<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">Length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> size<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">indexOf</span><span class="token punctuation">(</span>Node node<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//循环标志</span>        <span class="token keyword">boolean</span> isMatch<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">//查找成功标志</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>head<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>node<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>                isMatch<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isMatch<span class="token punctuation">)</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"该元素不存在！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> i<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> size<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><h2 id="队列"><a href="#队列" class="headerlink" title="队列"></a>队列</h2><h3 id="链表结构（尾插法）"><a href="#链表结构（尾插法）" class="headerlink" title="链表结构（尾插法）"></a>链表结构（尾插法）</h3><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//队列类（单链表实现-尾插法）</span><span class="token keyword">class</span> <span class="token class-name">QueueList</span> <span class="token keyword">implements</span> <span class="token class-name">Queue</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> Node head<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">QueueList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        head<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//计算队列长度（不包含头节点）</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">Length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>        Node temp<span class="token operator">=</span>head<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>temp<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            temp<span class="token operator">=</span>temp<span class="token punctuation">.</span>next<span class="token punctuation">;</span>            i<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> i<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//队列是否为空</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> head<span class="token punctuation">.</span>next<span class="token operator">==</span>null<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//查找节点位置索引</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">indexOf</span><span class="token punctuation">(</span>Node node<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">//队列为空报错</span>             <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"当前队列为空，请先添加元素！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//循环计数器</span>        <span class="token keyword">boolean</span> isMatch<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//是否匹配成功标志</span>        Node temp<span class="token operator">=</span>head<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>temp<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>temp<span class="token operator">==</span>node<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//地址相同即为相同对象</span>                isMatch<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>            temp<span class="token operator">=</span>temp<span class="token punctuation">.</span>next<span class="token punctuation">;</span>            i<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isMatch<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"当前队列没有该元素！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> i<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//添加节点</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span>Node node<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        Node temp<span class="token operator">=</span>head<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>temp<span class="token punctuation">.</span>next<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            temp<span class="token operator">=</span>temp<span class="token punctuation">.</span>next<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>temp<span class="token operator">==</span>node<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"该元素已经添加过！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        temp<span class="token punctuation">.</span>next<span class="token operator">=</span>node<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//弹出节点</span>    <span class="token keyword">public</span> Node <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        Node tempNode<span class="token operator">=</span>null<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"队列为空！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            tempNode<span class="token operator">=</span>head<span class="token punctuation">.</span>next<span class="token punctuation">;</span>            head<span class="token punctuation">.</span>next<span class="token operator">=</span>head<span class="token punctuation">.</span>next<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> tempNode<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><h3 id="数组结构（循环数组）"><a href="#数组结构（循环数组）" class="headerlink" title="数组结构（循环数组）"></a>数组结构（循环数组）</h3><p>在使用数组实现队列时容易形成<strong>假满</strong>现象，设想一下一个数组里元素为满的情况下从数组首元素开始出队列，直到剩下最后一个元素，若此时需要添加新的元素因为尾部已经没有空间，所以造成了空间浪费，因而采用循环数组的形式实现。</p><p><img src="https://i.loli.net/2020/01/30/PKje7TAEwH1hdn8.png" alt="循环队列"></p><p>实现的方法主要是下一个位置对数组长度求余，比如数组长度为5，当前数组最后一个位置刚填入一个元素，那么下次的位置应该为0号位置（5%5=0）。</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//队列类（循环数组实现）</span><span class="token keyword">class</span> <span class="token class-name">QueueArray</span> <span class="token keyword">implements</span> <span class="token class-name">Queue</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> Length<span class="token punctuation">;</span>    <span class="token keyword">private</span> Node<span class="token punctuation">[</span><span class="token punctuation">]</span> head<span class="token operator">=</span>null<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//数组结构时实现循环队列需要此变量，链表结构不需要</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> front<span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">//队首指针</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> rear<span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">//队尾指针</span>    <span class="token keyword">public</span> <span class="token function">QueueArray</span><span class="token punctuation">(</span><span class="token keyword">int</span> length<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        Length<span class="token operator">=</span>length<span class="token punctuation">;</span>        head<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">[</span>Length<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//队首队尾都指向0号位置</span>        front<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>        rear<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">Length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>i<span class="token operator">&lt;</span><span class="token keyword">this</span><span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>head<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>                count<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>            i<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> count<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> front<span class="token operator">==</span>rear<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">isFull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>rear<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>Length<span class="token operator">==</span><span class="token keyword">this</span><span class="token punctuation">.</span>front<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">indexOf</span><span class="token punctuation">(</span>Node node<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//循环标志</span>        <span class="token keyword">boolean</span> isMatch<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"队列为空！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>head<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>head<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>node<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>                isMatch<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>            i<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isMatch<span class="token punctuation">)</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"该元素不存在"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> i<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span>Node node<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isFull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"队列已满！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        head<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>rear<span class="token punctuation">]</span><span class="token operator">=</span>node<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>rear<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>rear<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>Length<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> Node <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"当前队列为空！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Node temp<span class="token operator">=</span>head<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>front<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>front<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>front<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>Length<span class="token punctuation">;</span>        <span class="token keyword">return</span> temp<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 数据结构与算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 栈 </tag>
            
            <tag> 队列 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
